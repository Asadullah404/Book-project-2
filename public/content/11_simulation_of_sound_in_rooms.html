<div class="chapter-content space-y-6" id="11. Simulation of Sound in Rooms">
    <h2 id="chapter-11" class="text-3xl font-bold mt-12 mb-6 text-gray-900 dark:text-white border-b pb-2">Chapter 11
        Simulation of Sound in Rooms</h2>
    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Chapter 11 Simulation of Sound in
        Rooms</p>

    <h3 id="11.1-introduction" class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.1
        Introduction</h3>
    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">In this chapter, we will discuss the
        fundamental algorithms of geometrical acoustics, their variations of implementation in software and their ef fi
        ciency. It will be shown that pure specular models (image models) are not capable of simulating room sound fi
        elds suf fi ciently accurate. But combinations of models of image sources and statistical models such as Ray
        Tracing and radiosity will allow a simulation with acceptable plausibility. Hybrid models which can handle
        specular and diffuse re fl ections for the estimation of the late reverberation spectrum are the solution to
        obtain impulse responses very near to measurement results. For inclusion of wave effects, hybrid models
        combining numerical methods (FEM, BEM, etc.) with geo- metrical acoustics have been introduced.</p>
    <h3 id="11.2-general" class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.2 General</h3>
    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Computer modelling of room acoustics
        was fi rst proposed during the 1960s by Schroeder et al. (1962) and used in practice by Krokstad et al. (1968)
        and Schroeder (1973). Although room-acoustic scale model experiments are a powerful tool still today, computer
        simulations are increasingly taking over the part of scale models in consulting. Commercial software became more
        user-friendly, more accurate and, last but not least, cheaper than scale models. As soon as the architectural
        plan is transferred into a computer fi le and the wall data, and the source and receiver locations are de fi
        ned, the sound propagation in the room can be simulated quite fast and modi fi cations can be tested without
        large effort. The algorithms of typical programmes are based on geometrical acoustics (Sect. 10.2.3 ). In
        geometrical acoustics, the description of the sound fi eld is reduced to energy, transition time and direction
        of rays. This approach is correct as long as the</p>
    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">© Springer Nature Switzerland AG 2020
        M. Vorländer, Auralization, RWTHedition, https://doi.org/10.1007/978-3-030-51202-6_11</p>
    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">171</p>
    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">172 11 Simulation of Sound in Rooms
    </p>
    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Table 11.1 Basic algorithms of room
        acoustics computer simulations</p>
    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Algorithm Category Energy spreading by
        distance Energy detectors Ray tracing Stochastic Stochastic by counting Volumes Image sources Deterministic
        Deterministic by distance Points</p>
    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">dimensions of the room are large
        compared to the wavelengths and as long as broadband signals are considered. These approximations are valid with
        suf fi cient accuracy in large rooms above cut-off frequency f c , see Eq. ( 4.13 ). In intercomparison tests
        (so-called round robin tests) (Vorländer 1995; Bork 2000a, b), the ef fi ciency and the limits of room acoustics
        computer simulation (see 11.6 ) were evaluated. Finally, auralization has been included in room acoustics
        simulation since the beginning of the 1990s (see Sect. 11.7 ). The methods introduced in this chapter are, at fi
        rst, used to calculate the room acoustic criteria ( T , EDT, D , C , T S , LF, IACC...), see Sect. 6.5 , to get
        a more speci fi c result than given by the estimation (Sect. 6.5.6 ). Two techniques of geometrical acoustics
        have to be distinguished: “ ray tracing ” and “ image sources ” . Independent of their software implementation,
        they represent different physical approaches. In order to achieve a clear understanding, this point is to be
        stressed, since ray tracing algorithms can well be used to calculate and handle image sources. The main
        difference between ray tracing (in classical de fi nition) and image sources is the way how energy detection and
        the internal nature of the physical energy propagation are implemented (Table 11.1 ).</p>
    <h4 id="11.2.1-cad-room-model" class="text-xl font-semibold mt-6 mb-3 text-gray-800 dark:text-gray-200">11.2.1 CAD
        Room Model</h4>
    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">For implementation of the algorithm
        described in the software, the room geometry, the sound sources and the receivers must be de fi ned as
        mathematical objects. We start the discussion with the question of how to create a CAD model of the test room.
        The complexity of the model may be very high, particularly when it was exported from software for architectural
        design. These models include small details like staircase steps or even smaller geometric features. From an
        acoustic point of view, however, this kind of model would not only be too large in memory size and polygon
        complexity, it would also be wrong. As will be shown below, the acoustic characterization of surfaces is based
        on absorption and scattering. And the physical principles of wave re fl ection and scattering are clearly de fi
        ned (see 3.4 ). Objects or surface corrugations which are not large compared to the wavelengths have to be taken
        out the CAD model and replaced by a fl at surface with adequate acoustic properties. This holds true also for
        chairs and audience seats, for lamps and for doorknobs. For the purpose of visualization, these elements are
        essential for a realistic impression. For the “ acoustic view ” they are invisible or at most visible with some
        diffuse halo (Fig. 11.1 ).</p>
    <h3 id="11.2-general-173" class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.2 General 173
    </h3>
    <div class="my-8 flex justify-center"><img src="/content/images/chapter11/11_img_1_2.jpeg"
            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md"></div>
    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig. 11.1 Visual wireframe model of a
        multipurpose hall</p>
    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">As a rule of thumb, the guideline
        might be used to draw the room surfaces and the interior with a resolution of 0.5 m, representing a wavelength
        scale corresponding to a frequency of about 700 Hz. Below that frequency, the surfaces should be modelled as fl
        at specularly re fl ecting polygons, above as partly scattering surfaces or objects (Fig. 11.2 ). Sound
        scattering dominates at high frequencies anyway, except for very large walls or the ceiling (>10 m). The only
        reason for including a small resolution of details (<0.5 m) would be a study of a frequency range with small
            wavelengths compared to 0.5 m, say, for λ ¼ 5 cm. Then, frequencies around 7 kHz and above are discussed.
            For several reasons this would only be of interest in very special cases. The main arguments for choosing a
            range of lower frequencies are:</p>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">1. The spectral content
                excited by natural sources (voice or instruments) is small above 7 kHz. 2. In broadband signal
                situations, masking will not allow humans to identify details of low levels at high frequencies. 3. The
                accuracy of the simulation model is not suf fi ciently high to guarantee results within an acceptable
                con fi dence limit.</p>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Not much research has yet been
                done on automatic simpli fi cation of CAD models from detailed resolution towards a speci fi c
                acoustically relevant resolution. Polygon smoothing by using spatial low-pass fi lters with a cut-off
                wave number of 125 m  1</p>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">(equivalent to a minimum
                length resolution of 50 cm) could be an interesting option for future automized CAD user interfaces.</p>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">174 11 Simulation of Sound in
                Rooms</p>
            <div class="my-8 flex justify-center"><img src="/content/images/chapter11/11_img_2_3.jpeg"
                    alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md"></div>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig. 11.2 Visual surface model
                of a multipurpose hall</p>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">In the end, the room must be
                approximated by analytic surfaces, typically by planes. Surfaces of higher order (cylindrical,
                spherical, parabolic, etc.) can be used in principle (see below). All surfaces lying in a common plane
                are forming a “ wall ” . A wall, thus, needs not to be simply connected. Walls can also be made up of
                more than one surface material. One very effective simpli fi cation, however, is the requirement for
                convex wall shapes, as it simpli fi es and thus accelerates time-consuming tests, such as the
                point-in-polygon test which is a frequently called function in all kinds of room acoustics simulation
                algorithms. This rule is no practical constraint in model- ling a room shape at all (Fig. 11.3 ). All
                plane surfaces are de fi ned by three points in a previously fi xed coordinate system. Preferably,
                points (called “ vertices 1 ” ) of the wall polygon are used. To de fi ne the polygon completely, the
                other vertices of the polygon must be added, too. In practice, geometric uncertainties in adding the
                fourth, fi fth, etc. vertices in the polygon ’ s plane can be allowed, if the new corners are
                automatically adjusted to match the plane (at least numerically) exactly (Fig. 11.4 ). Figure 11.5
                illustrates the strategy to build a 3D room from 2D polygons. The polygon-to-vertex notation, the
                polygon orientation with reference to the normal vector and their address management must be speci fi ed
                with great care in order to avoid errors caused by open faces or gaps.</p>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">1 From “ vertex ” .</p>
            <h3 id="11.2-general-175" class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.2
                General 175</h3>
            <div class="my-8 flex justify-center"><img src="/content/images/chapter11/11_img_3_4.jpeg"
                    alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md"></div>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig. 11.3 From architectural
                to acoustic CAD models: Acoustic surface model of a multipurpose hall. Geometric details are replaced by
                smooth wall polygons</p>
            <div class="my-8 flex justify-center"><img src="/content/images/chapter11/11_img_4_4.jpeg"
                    alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md"></div>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig. 11.4 Left: convex
                polygons, right: concave polygons</p>
            <h4 id="11.2.2-absorption-coef-fi-cients"
                class="text-xl font-semibold mt-6 mb-3 text-gray-800 dark:text-gray-200">11.2.2 Absorption Coef fi
                cients</h4>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Absorption coef fi cients can
                be found in tables (see Annex) or they can be taken from speci fi c test results. Most absorption coef
                fi cients correspond to diffuse sound inci- dence, as they were obtained from measurements in
                reverberation chambers (ISO354). In ray tracing, this data represents the average absorption at random
                incidence. Thus, in rooms which provide an approximate diffuse fi eld, they serve well, particularly in
                the late response where in the region of high-order re fl ections the average absorption coef fi cient
                is an appropriate quantity. The energy losses of the fi rst re fl ections at their speci fi c angles of
                incidence, however, are not modelled</p>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">176 11 Simulation of Sound in
                Rooms</p>
            <div class="my-8 flex justify-center"><img src="/content/images/chapter11/11_img_5_5.jpeg"
                    alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md"></div>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig. 11.5 ( a ) Example: a
                simple room constructed by a set of convex polygons. ( b ) The room ’ s 2D projection: the green area
                marks a solid object inside the room. ( c ) De fi nition of the spanning direction for polygons. ( d )
                The room ’ s 2D projection: the green area marks the outside world. (Example after Schröder 2011;
                Schröder and Lentz 2006)</p>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">precisely. Nevertheless the
                errors are small. It should be kept in mind that the difference between energy loss at a speci fi c
                angle of incidence and random incidence may be up to 40%, until the error of the re fl ection level
                exceeds 2 dB. Only for grazing incidences, the errors may become larger. But in grazing incidences other
                in fl uences come into play anyway (see Sect. 11.6 ). If the complex wall impedance is known, the
                angle-dependent absorption coef- fi cient can be calculated. This is easy for the case of real-impedance
                locally reacting walls (see Eqs. 3.3 , 3.4 , 3.5 and 3.6 ). In each case of room simulation, it should
                be checked if random-incidence absorption coef fi cients are applicable or if angle- dependent data are
                possibly required. The latter may, for example, apply to long or fl at rooms, tunnels, corridors, and
                coupled rooms.</p>
            <h4 id="11.2.3-scattering-coef-fi-cients"
                class="text-xl font-semibold mt-6 mb-3 text-gray-800 dark:text-gray-200">11.2.3 Scattering Coef fi
                cients</h4>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">If absorption is treated in a
                simpli fi ed way (assuming random incidence), this simpli fi cation is even more justi fi ed for surface
                scattering. Nevertheless angle- dependent scattering is interesting for discussing low-order re fl
                ections. The total fi eld in front of a diffuser, depending on the signal ’ s spectrum and coherence
                length, is very complicated (Sect. 3.4 ). Data from free- fi eld measurements (part 2 of (ISO17497)) or
                calculations can be obtained by using standardized methods, but these are valid only for harmonic
                signals.</p>
            <h3 id="11.3-stochastic-ray-tracing-177"
                class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.3 Stochastic Ray Tracing
                177</h3>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Therefore, with the same
                argument as used above, we assume random-incidence appropriate, and we accept the unavoidable
                uncertainties which are small in the case of high-order re fl ections. But we must be aware of the
                problems which can arise at fi rst- or second-order re fl ections. Random-incidence scattering coef fi
                cients are not available to the same extent as absorption data. However, with the measurement method
                recently standardized in (ISO17497), more information may be published in the future (see Annex).</p>
            <h3 id="11.3-stochastic-ray-tracing"
                class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.3 Stochastic Ray Tracing
            </h3>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">In this model sound is
                radiated as a bunch of particles – many particles ( ¼ rays). The number of particles is one of the
                crucial features of ray tracing. It is considered to be in the category of Monte-Carlo methods, to
                express the in fl uence of probabilistic effects, as, for example, in gambling (Fig. 11.6 ).</p>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Stochastic Ray Tracing in
                Short The sound source radiates an impulse. To simulate this, the particles are started at the same
                initial time in various directions. Each ray carries certain energy, propagates at speed of sound and
                once in a while hits the room boundary, for simplicity called “ wall ” throughout. From the wall it is
                re fl ected, hits another wall and so on. Each wall absorption reduces the particle ’ s energy (Fig.
                11.7 ).</p>
            <div class="my-8 flex justify-center"><img src="/content/images/chapter11/11_img_6_6.jpeg"
                    alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md"></div>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig. 11.6 Free- fi eld
                propagation and distance law “ by counting ”</p>
            <div class="my-8 flex justify-center"><img src="/content/images/chapter11/11_img_7_6.jpeg"
                    alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md"></div>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig. 11.7 Tracing a ray from
                the source to the detector</p>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">178 11 Simulation of Sound in
                Rooms</p>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig. 11.8 Creating an impulse
                response by counting events</p>
            <div class="my-8 flex justify-center"><img src="/content/images/chapter11/11_img_8_7.jpeg"
                    alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md"></div>
            <div class="my-8 flex justify-center"><img src="/content/images/chapter11/11_img_9_7.jpeg"
                    alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md"></div>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig. 11.9 Variants of ray
                sources, spherical coordinate system and regular grid (top left), uniform random distribution (top
                right), concentration of rays at the equator (line-arry-like) (bottom left) and concentration of rays at
                the north pole (baf fl ed-piston-like) (bottom right)</p>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">By means of particle
                detectors, the particle ’ s energy and the time elapsed since radiation from the source is registered
                (see Fig. 11.8 ). The number of counts represents the energy detected at the receiver point.</p>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Source Modelling Sound sources
                are characterized by sound power and directivity (Sect. 2.5 ). Both depend on frequency. For ray tracing
                we just need the source position and the reference (on-axis) direction. The directivity can be modelled
                by choosing direction-speci fi c start energies of the particles, or by variation of the density of the
                particles, as illustrated in Fig. 11.9 in an area-accurate plot of the unit sphere.</p>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">To create a spherically
                uniform radiation, we proceed as follows: The azimuth angles are distributed evenly around the
                perimeter. The distribution of polar angles is to be chosen in a way that the ray density is constant.
                This is achieved by using a random number z 2 (0,1) (or by dividing the interval (0,1) into fi xed
                steps) and taking the polar angle of radiation as</p>
            <h3 id="11.3-stochastic-ray-tracing-179"
                class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.3 Stochastic Ray Tracing
                179</h3>
            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">8 > << /p>
                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">arccos z</p>
                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">θ ¼</p>
                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">> : ð 11 : 1 Þ</p>
                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">,</p>
                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">arccos z þ π = 2</p>
                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">the upper choice for
                        the northern and the lower for the southern hemisphere. θ ¼ 0 at the north pole. Other weighting
                        functions create polar distributions with concentra- tion of rays at the north pole (reference
                        axis) or at the equator. Any measured or calculated directional pattern can also be used as a
                        spherical weighting function of the ray energy or of the ray density.</p>
                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Flow Diagram Due to
                        the frequency dependence of absorption, ray tracing must be repeated for the frequency bands of
                        interest, usually octave bands or one-third octave bands. 2 Air attenuation can also be modelled
                        by reducing the ray ’ s energy according to the fl ight distance and the attenuation coef fi
                        cient.</p>
                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">We will now focus on
                        ray tracing algorithms in more detail. There are two options for modelling absorption. It is
                        obvious the energy can be reduced by multiplying the incident energy with a factor (1  α ). The
                        alternative is to apply stochastic annihila- tion of particles. Both algorithms yield identical
                        results in the limit of large numbers. But they differ in computation time and in accuracy. In
                        absorption by multiplication, the particle starts with energy e 0 and is traced until a maximum
                        travel time t max , or until a minimum energy, e min , is reached. In the method of absorption
                        by annihilation, a random number z 2 (0,1) is compared with the absorption coef fi cient, α . If
                        z < α , the particle is annihilated, and the next particle is traced; see fl ow diagram in Fig.
                            11.10 . As long as there is absorption somewhere in the room, we do not need to fi x another
                            truncation criterion, like t max or e min .</p>
                            <h4 id="11.3.1-point-in-polygon-test"
                                class="text-xl font-semibold mt-6 mb-3 text-gray-800 dark:text-gray-200">11.3.1
                                Point-in-Polygon Test</h4>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">The innermost
                                loop of ray tracing algorithms is a test for (a) whether a ray (particle), represented
                                as line segment, is hitting a plane and (b) whether the intersection point is inside or
                                outside a wall polygon. At this step, the actual straight line and the direction of
                                propagation, thus a vector, is known. Also known is the set of polygons. The polygons
                                quali fi ed (those located in the forward direction of the ray) are transformed in 2D
                                coordinate systems of the polygon planes and tested by calculat- ing vector products of
                                the vectors from the plane intersection point to vertices of the polygon. For all
                                neighbouring vertices, the vector product must have the same</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">2 Under
                                special circumstances parallel processing of frequency bands is possible; see below.</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">180 11
                                Simulation of Sound in Rooms</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig. 11.10
                                Flow diagram of ray tracing</p>
                            <div class="my-8 flex justify-center"><img src="/content/images/chapter11/11_img_10_9.jpeg"
                                    alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md"></div>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">direction.
                                Otherwise the intersection point is outside the polygon. An advantage of this algorithm
                                is that it can be cancelled if the vector is oriented in opposite direction.</p>
                            <h4 id="11.3.2-re-fl-ection"
                                class="text-xl font-semibold mt-6 mb-3 text-gray-800 dark:text-gray-200">11.3.2 Re fl
                                ection</h4>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">In the case of
                                the intersection point being inside the polygon, the new travel line will be the input
                                variable for the next plane hit. Before re fl ection takes place, wall materials affect
                                sound by absorption, scattering and diffraction. If a ray/particle hits a wall, it will
                                lose energy or be annihilated, 3 and it will change the travel direction.</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Specular Re fl
                                ection At specular re fl ection, a new direction at a specular angle with reference to
                                normal incidence will be calculated. The new ray vector is in the plane spanned by the
                                incident ray and the normal vector of the polygon.</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Classical
                                Surface Scattering When scattering occurs, which applies to the case that a random
                                number exceeds the scattering coef fi cient, the new direction is obtained from two more
                                random numbers.</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">3 Depending on
                                the way absorption is implemented.</p>
                            <h3 id="11.3-stochastic-ray-tracing-181"
                                class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.3
                                Stochastic Ray Tracing 181</h3>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Mostly, a
                                directional distribution according to Lambert ’ s law is assumed. On average, the polar
                                angles of the new fl ight direction (with reference to the wall normal vector) must be
                                distributed according to</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">w θ ð Þ d Ω ¼
                                1 π cos θ d Ω : ð 11 : 2 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">The azimuth
                                angle is evenly distributed in (0, 2 π ). Hence, two random numbers z 1 and z 2 in (0,1)
                                and transformations</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">θ ¼ arccos
                                ﬃﬃﬃﬃ z 1 p ð 11 : 3 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">and</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">ϕ ¼ 2 π z 2 ð
                                11 : 4 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">yield a polar
                                scattering distribution according to Lambert ’ s law. Superposition of the specular
                                direction vector and the scattering direction vector is also a possible solution to de
                                fi ne the new direction.</p>
                            <h4 id="11.3.3-detectors"
                                class="text-xl font-semibold mt-6 mb-3 text-gray-800 dark:text-gray-200">11.3.3
                                Detectors</h4>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Surface or
                                volume detectors are possible options. While surface detectors have an angle-dependent
                                cross section, spherical detectors are independent of the angle of incidence. The
                                detection cross section of spheres is</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">M sphere ¼ π r
                                2 d ð 11 : 5 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">with r d
                                denoting the detector radius. Thus, the detector position (centre point) is a suf fi
                                cient information. Each line segment representing the ray has to be checked whether it “
                                hits ” the detector. This test requires a calculation of the distance between the
                                detector centre point and the ray vector. It is solved by fi nding the perpendicular
                                line between the ray and the detector and by checking if this distance is smaller than
                                the detector radius, r d . This way of ray detection represents an omnidirectional
                                microphone. It does not represent a live audience. All physical effects of audience
                                areas known in room acoustics are neglected. The most prominent effects are the seat-dip
                                effect and the forward scattering at the audience ’ s heads. It was tried to include
                                both (wave) effects in models of detectors, but all attempts suffer from inconsistencies
                                with geometrical acoustics. Anyway, audience effects can be modelled as speci fi c
                                feature of audience areas, independent of detector modelling. Complex impedance and
                                diffraction</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">182 11
                                Simulation of Sound in Rooms</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">models are
                                options for including audience effects in future simulation models, however, not in
                                stochastic ray tracing models, but in deterministic models (see below). For inclusion of
                                spatial information, the receiver can be modelled as a binaural receiver (see 6.4.1 ) or
                                as an equivalent to a microphone array (see 2.6 ). Depending on the choice of the
                                spatial encoding scheme, the incoming sound fi eld represented by the rays can be
                                transformed into spherical harmonics or fi ltered in two channels for the left and the
                                right ear by using HRTF. With the array approach, the binaural format can also be
                                introduced later in post-processing, which is more fl exible as concerns usage of
                                individual HRTF. For this, the spherical harmonic representation of the rays can be fi
                                ltered with the HRTF of interest, or the sound fi eld can be decomposed into plane waves
                                and then fi ltered with HRTF.</p>
                            <h4 id="11.3.4-linking-scattering-and-detectors:--“-diffuse-rain-”"
                                class="text-xl font-semibold mt-6 mb-3 text-gray-800 dark:text-gray-200">11.3.4 Linking
                                Scattering and Detectors: “ Diffuse Rain ”</h4>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">In stochastic
                                ray tracing, the simulation results suffer from the discrete representation of sound by
                                using a fi nite number of rays, as discussed in 11.3.7 . The concept of the “ diffuse
                                rain ” is bene fi cial for reducing the stochastic uncertainties by replacing the
                                discrete ray tracing between a diffusely scattering wall and the receiver. The energy re
                                fl ected at this point is calculated analytically by using the wall ’ s absorption and
                                scattering coef fi cients, the distribution of scattered energy, following a Lambert
                                distribution, for example, and the detector ’ s effective cross section, a purely geo-
                                metrical quantity. The effective cross section is determined by integrating the
                                respective probability density function, which is formed by the contour of the receiver
                                projected onto a sphere around the intersection point. γ is the opening angle, and r the
                                distance from the ray ’ s intersection point to the centre of the detector (Fig. 11.11
                                ).</p>
                            <div class="my-8 flex justify-center"><img src="/content/images/chapter11/11_img_11_11.jpeg"
                                    alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md"></div>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig. 11.11
                                Diffuse rain. (After Schröder 2011)</p>
                            <h3 id="11.3-stochastic-ray-tracing-183"
                                class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.3
                                Stochastic Ray Tracing 183</h3>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">The crucial
                                problem is to fi nd a suf fi ciently precise estimate for arbitrary solid angles. A good
                                approximation is to evaluate this distribution only for a fi xed angle, θ , which is the
                                angle between the surface normal and the connection vector between the intersection
                                point and the receiver. The effective cross section is then combined from the (Lambert)
                                energy radiation and the geometric cross section.</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">w total ¼ w
                                Lambert  w geo ð 11 : 6 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">For spherical
                                detectors, the scattered energy is after Schröder (2011) referring to Heinz (1993)</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">  2 cos θ ð
                                11 : 7 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">e s ¼ e ray s
                                1  α ð Þ 1  cos γ 2</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">e ray denotes
                                the energy of the incident ray, and α and s the absorption and scattering coef fi cients
                                of the wall, respectively. Similarly, the diffuse rain processing can be performed for
                                plane or cylindrical receivers.</p>
                            <h4 id="11.3.5-presentation-of-results"
                                class="text-xl font-semibold mt-6 mb-3 text-gray-800 dark:text-gray-200">11.3.5
                                Presentation of Results</h4>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Up to this
                                point ray tracing was described in an abstract way. By discussing typical results, we
                                can better interpret the quality, the ef fi ciency and the bene fi t of ray tracing. At
                                each detection, the ray ’ s energy, arrival time and direction of incidence are stored
                                in an array called histogram of the energy impulse response (Fig. 11.12 ). The array
                                must have a sampling rate which allows a suf fi ciently high temporal resolution, on the
                                one hand, and suf fi ciently large integration intervals, on the other (see below,
                                11.3.7 ). A good compromise is a resolution in the order of milliseconds psychoacoustic
                                post processing (Sect. 6.5 ) can be taken into account properly (Fig. 11.13 ), but
                                binaural attributes like ITD are uncertain 4 . At the same time it is clear that we
                                cannot meet the requirement for a sampling rate adequate for audio signal processing and
                                auralization. 5</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">One could
                                argue that auralization with stochastic ray tracing could be possible with faster
                                computers. This, however, is not a reasonable goal since ray tracing is a rough
                                approximation of wave propagation. Any increase of accuracy and temporal resolution
                                would only mimic a real gain of physical accuracy. Ray tracing still remains an
                                approximation of wave propagation.</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">4 It will be
                                shown in Sect. 11.3.7 that the required number of rays would be unacceptably high. 5 The
                                temporal resolution for a sampling frequency of 44.1 kHz is 22.7 μ s.</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">184 11
                                Simulation of Sound in Rooms</p>
                            <div class="my-8 flex justify-center"><img src="/content/images/chapter11/11_img_12_13.jpeg"
                                    alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md"></div>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig. 11.12 Ray
                                tracing energy impulse response (top, linear plot for several frequency bands; bottom,
                                logarithmic plot for one frequency band)</p>
                            <h4 id="11.3.6-curved-surfaces"
                                class="text-xl font-semibold mt-6 mb-3 text-gray-800 dark:text-gray-200">11.3.6 Curved
                                Surfaces</h4>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Inappropriate
                                architectural room designs may lead to severe acoustic problems. Curved walls belong to
                                the category of high-risk potential. Strong spatial and temporal concentrations of sound
                                ( ¼ “ echoes ” ) must be avoided, since sound focusing is against all goals of room
                                acoustic design to achieve the best possible</p>
                            <h3 id="11.3-stochastic-ray-tracing-185"
                                class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.3
                                Stochastic Ray Tracing 185</h3>
                            <div class="my-8 flex justify-center"><img src="/content/images/chapter11/11_img_13_14.jpeg"
                                    alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md"></div>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig. 11.13
                                Examples for room acoustic parameters plotted in the CAD model (audience area); see
                                Sect. 6.5 and particularly 6.5.6</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">uniform
                                distribution of good acoustic quality. In rooms with cylindrical side walls or with
                                dome-shape ceilings, we have to expect focusing. If a room acoustic computer simulation
                                is to be a tool for design, it must be ensured that occurrences of focusing and echoes
                                are clearly visible in the results (Fig. 11.14 ). An exact model of the room geometry by
                                using curved surfaces may be even faster than the approximation by planes. To obtain
                                accurate results with ray tracing, the detectors must be small and the number of rays
                                large. It was shown by Kuttruff (1993) and later by Vercammen (2010) that deterministic
                                approaches with coherent wave methods can be used. This is obvious since the sound
                                pressure in the focal region cannot be obtained by energetic models. Kuttruff pointed
                                out that the approximation of a cylinder with radius a by planes of width b is suf fi
                                cient if</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">f b 2 ¼ 1 2 c
                                a ð 11 : 8 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">is ful fi
                                lled. It is interesting that this equation is frequency dependent. Thus, the condition
                                must be checked for the highest frequency band involved, or the shape must be modelled
                                to be frequency-dependent. For example, a cylindrical shape with radius 10 m must be
                                modelled by panels of a width of 50 cm, if the frequency range should reach up to 8 kHz,
                                which means that the cylinder should be subdivided into 136 plane elements.</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">186 11
                                Simulation of Sound in Rooms</p>
                            <div class="my-8 flex justify-center"><img src="/content/images/chapter11/11_img_14_15.jpeg"
                                    alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md"></div>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig. 11.14 ( a
                                ) Ground plan of a small theatre (volume 900 m 3 ) with source and receiver positions, (
                                b ) measured impulse response (2 kHz octave) and comparison with simulated impulse
                                responses, ( c ) approximation of 5 plane surfaces, ( d ) mathematically exact model of
                                the cylindrical back wall. (After Mommertz 1996)</p>
                            <h4 id="11.3.7-reproducibility-in-stochastic-ray-tracing"
                                class="text-xl font-semibold mt-6 mb-3 text-gray-800 dark:text-gray-200">11.3.7
                                Reproducibility in Stochastic Ray Tracing</h4>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">In all
                                physical measurement and simulation methods, systematic uncertainties are present. The
                                approximations inherent in the input data (room geometry, absorption and scattering coef
                                fi cients) and in the model itself (approximation of wave physics by a geometrical
                                model) are causes for systematic errors. These errors cannot be reduced by an increased
                                computational effort. Independently, in Monte-Carlo methods like ray tracing, we must
                                consider stochastic fl uctuations in the results. By increasing the number of rays or by
                                averaging repeated simulations, these errors can be reduced. The number of launched
                                rays, N , is of crucial importance, because it affects both the reproducibility and the
                                computation time t calc . The goal of this chapter is the prediction of the standard
                                deviation in the simulation results in dependence on N and t calc . For obtaining an
                                expectation value</p>
                            <h3 id="11.3-stochastic-ray-tracing-187"
                                class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.3
                                Stochastic Ray Tracing 187</h3>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">of the error,
                                we need to remember that the energy impulse response was created by counting events of
                                particle detection. The number of hits, k , in a detector sphere with radius r d , in a
                                time interval, Δ t , is of particular interest, as well as the detection rate, r , of
                                hits per second. The probability of a ray hitting the detector within Δ t is small but
                                constant in time, if the number of rays in the room throughout the simulation is
                                constant. The expectation value < k> is thus constant and follows a Poisson
                                    distribution:</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">P k ð Þ ¼ k h
                                i k ! e  k h i ð 11 : 9 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">The variance
                                of the Poisson distribution, σ 2 , describes the fl uctuations around the expectation
                                value. It is</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">σ 2 k ¼ k ¼ r
                                Δ t ð 11 : 10 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">The number of
                                hits is thus related to the following expected error:</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">σ k k h i ¼ 1
                                ﬃﬃﬃﬃﬃﬃ k h i p : ð 11 : 11 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">The
                                expectation value of the count rate < r> is calculated from the number of wall hits per
                                    second, nN , and the ratio of the detector surface, 4 π r d 2 , and the room
                                    surface, S :</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">r h i ¼  nN 4
                                π r 2 d S ð 11 : 12 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Herein, n is
                                the mean re fl ection rate according to Eq. ( 4.22 ). The mean count rate is thus</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">r h i ¼ N π r
                                2 d c V , ð 11 : 13 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">and the mean
                                number of hits is</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">k ¼ N π r 2 d
                                c Δ t V : ð 11 : 14 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Now we can
                                calculate the expectation value of the energy, < E>, per time interval Δ t . This can be
                                    obtained only when some features of the sound fi eld are assumed. The diffuse sound
                                    fi eld is chosen, as the best guess for a room sound fi eld. This approach is, by
                                    the way, exactly the same as in statistical reverberation</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">188 11
                                Simulation of Sound in Rooms</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">theory (Sect.
                                4.5 ). Of course, an exponential decaying < E> will be found, which actually better
                                    matches the late decay in a real room. Thus, early re fl ections are not discussed
                                    here. The theory is identical with that discussed in Sect. 4.5 . Therefore,</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">E t ð Þ ¼ e 0
                                N 1  α ð Þ  nt ¼ e 0 Ne  n ln 1  α ð Þ ½  t ¼ e 0 Ne  13 : 8 T , ð 11 : 15 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">with e 0
                                denoting the start energy of rays. Depending on the absorption model used, the
                                energy-time curve is represented by the count rate and the number of hits.</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Energy
                                Multiplication In this model the number of rays (particles) in the room and the average
                                hits of the detector remain constant (Eq. 11.14 ). The mean energy therefore is</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">E h i ¼ k h i
                                e 0 e  13 : 8 t T ð 11 : 16 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">and</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">s</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">V N π r 2 d c
                                Δ t</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">σ E E ¼ σ k k
                                ¼</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">: ð 11 : 17 Þ
                            </p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">The relative
                                error σ E / h E i is easier to be interpreted when expressed in decibels. Now, we can
                                use the fact that the time-dependent sound pressure level is</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">L ETC ¼ 10 log
                                E = E 0 ð Þ ð 11 : 18 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">with an
                                arbitrary reference E 0 , and</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">σ ETC  dL dE
                                σ E ¼ 10 ln 10</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">σ E E h i : ð
                                11 : 19 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Thus,</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">s</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">V N π r 2 d c
                                Δ t</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">: ð 11 : 20 Þ
                            </p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">σ ETC ¼ 4 : 34
                            </p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">This error is
                                constant with respect to the time variable in the impulse response. It depends on the
                                ratio of the room volume and the number of rays, the detector size and the width of the
                                time intervals, V = N π r 2 d c Δ t (Fig. 11.15 ). Furthermore on the basis of E ,
                                integral parameters, like clarity or strength, can be obtained. The strength, for
                                instance (see Eq. 6.17 ), is derived from the integral: 6</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">6 Accordingly,
                                the sound power of the source, P , is equivalent to π cr 2 d e 0 N .</p>
                            <h3 id="11.3-stochastic-ray-tracing-189"
                                class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.3
                                Stochastic Ray Tracing 189</h3>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig. 11.15
                                Histogram result in logarithmic scale of stochastic ray tracing (absorption by energy
                                multiplication), expectation values, and uncertainty range according to Eq. ( 11.20 )
                                (example)</p>
                            <div class="my-8 flex justify-center"><img src="/content/images/chapter11/11_img_15_18.jpeg"
                                    alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md"></div>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Z 1</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">w ¼ X</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Δ t E  e 0 N
                                π r 2 d c V e 0</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">0 e  13 : 8 t
                                T dt</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">ð 11 : 21 Þ
                            </p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">¼ 4 π r 2 d e
                                0 N A</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">The
                                expectation value of this energy integral, < w>, also is affected by stochastic
                                    deviations. Due to the statistical independence of the hits in the Δ t intervals,
                                    the total variance of the integral is</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">σ 2 w ¼ X</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Δ t σ 2 E : ð
                                11 : 22 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">and, thus,
                                again expressed in decibels (applying the principle of Eq. ( 11.19 ) again)</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">s</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
                            </p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">A 8 π Nr 2 d
                            </p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">σ L ¼ 4 : 34
                            </p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">: ð 11 : 23 Þ
                            </p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">The most
                                important fact we observe is that the level errors depend on the square root of A / N .
                                Thus, in large and highly absorbing rooms (large A ), a larger number of rays (larger “
                                sound power ” ) is required, like in impulse response measurements, to overcome the
                                limit of the background noise fl oor. The noise, in this case, is represented by the
                                numerical noise given by the discrete ray formulation. Finally, the computation time
                                needs to be estimated. To obtain the number of operations, we have a look into the fl ow
                                diagram (Fig. 11.10 ). The inner loop is the tracing and re fl ection procedure
                                (vector/plane intersection). The number of walls to be checked is n w and the number of
                                detectors n d . The computation time required for the point-in-polygon test is t w , and
                                the time for checking detectors is t d . Without spatial data structures such as voxel
                                technique or binary space partitioning, BSP (see</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">190 11
                                Simulation of Sound in Rooms</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig. 11.16
                                Order of magnitude of elementary computation time per re fl ection as function of the
                                number of wall polygons, without and with binary space partitioning (example for PC with
                                2 GHz CPU in 2007) (From 2007 to 2020, computation times decreased by a factor of
                                roughly 5)</p>
                            <div class="my-8 flex justify-center"><img src="/content/images/chapter11/11_img_16_19.jpeg"
                                    alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md"></div>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">11.4.5 ), the
                                complete set of walls and detectors must be tested. The computation time for one re fl
                                ection is considered as elementary time, τ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">τ  n w t w þ
                                n d t d þ t c ð 11 : 24 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">with t c
                                denoting a constant offset for data management independent of the number of walls and
                                detectors. With BSP or similar spatial data structures, the elementary time is reduced
                                to</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">τ  log 2 n w
                                t w ð Þ þ log 2 n d t d ð Þ þ t c : ð 11 : 25 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">The elementary
                                time is to be multiplied with the events of re fl ections, Nnt max :</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">t calc ¼ Nnt
                                max τ ð 11 : 26 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">As a rough
                                estimate the following elementary computation times can be expected (see Fig. 11.16 and
                                Fig. 11.17 ). These plots illustrate the dependence of the com- putation time (order of
                                magnitude) on the number of walls and on the number of rays. The number of receivers is
                                set to n d ¼ 1.</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Annihilation
                                When using this method, more and more rays vanish. The decision to leave the inner loop
                                is made according to a random number. In the case of absorption, the next ray is started
                                (Fig. 11.18 ). The expectation value of the energy decreases with the running time in
                                the impulse response since the number of hits decreases exponentially</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">k ¼ N π r 2 d
                                c Δ t V e  13 : 8 t T , ð 11 : 27 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">and because of
                            </p>
                            <h3 id="11.3-stochastic-ray-tracing-191"
                                class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.3
                                Stochastic Ray Tracing 191</h3>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig. 11.17
                                Order of magnitude of the total computation time (order of magnitude) as function of the
                                number of rays, N (example for PC with 2 GHz CPU). The upper two broken lines represent
                                classical ray tracing, the lower curves show ray tracing with room subdivision strategy
                                (example BSP). The room volume is the same in all four cases</p>
                            <div class="my-8 flex justify-center"><img src="/content/images/chapter11/11_img_17_20.jpeg"
                                    alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md"></div>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig. 11.18
                                Flow diagram of ray tracing (annihilation)</p>
                            <div class="my-8 flex justify-center"><img src="/content/images/chapter11/11_img_18_20.jpeg"
                                    alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md"></div>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">E h i ¼ k h i
                                e 0 ð 11 : 28 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">results in an
                                increasing relative variation of the energy impulse response of</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">s</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">s</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">13 : 8 t T N π
                                r 2 d c Δ t</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">V  e</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">V N π r 2 d c
                                Δ t</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">σ E E ¼ σ k k
                                ¼</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">6 : 9 t T : ð
                                11 : 29 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">e</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">¼</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">192 11
                                Simulation of Sound in Rooms</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">The increase
                                of the uncertainty in the late reverberation tail is due to the loss of countable rays
                                caused by absorption. The statistical error of the integral energy level (in decibels)
                                is</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
                            </p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">s</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">A 4 π Nr 2 d
                            </p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">σ L ¼ 4 : 34
                            </p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">: ð 11 : 30 Þ
                            </p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">When comparing
                                the equation with Eq. ( 11.23 ), it can be observed that the difference in the integral
                                energy error has a factor of 0.7 in favour of the energy multiplication. This is mainly
                                due to the fact of disappearing rays and a smaller statistical basis. The computation
                                time can be estimated from the fl ow chart, too. But we have to determine the average
                                number of loops for each ray. The probability that it survives the ν - fi rst re fl
                                ection and is annihilated at the ν -th re fl ection is</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">w ν ð Þ ¼ 1 
                                α ð Þ ν  1 α , ð 11 : 31 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">with α
                                denoting the mean absorption coef fi cient (Eq. 4.30 ). Accordingly,</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">ν ¼ 0 ν w ν ð
                                Þ ¼ α X 1</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">ν h i ¼ X 1
                            </p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">ν ¼ 0 1  α ð
                                Þ ν  1 ¼ 1</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">α ð 11 : 32 Þ
                            </p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">and</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">t calc ¼ N τ
                            </p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">α : ð 11 : 33
                                Þ</p>
                            <h4 id="11.3.8-computation-times-versus-uncertainties:-case-studies"
                                class="text-xl font-semibold mt-6 mb-3 text-gray-800 dark:text-gray-200">11.3.8
                                Computation Times Versus Uncertainties: Case Studies</h4>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">In the
                                following we consider four example rooms as typical cases for categories of rooms used
                                for different purposes: A living room ( V ¼ 100 m 3 ), a lecture room (classroom) ( V ¼
                                1000 m 3 ), a concert hall ( V ¼ 10,000 m 3 ) and a large church ( V ¼ 100,000 m 3 ).
                                The rooms are modelled with a constant average absorption of α ¼ 0.15. The increasing
                                number of walls, n w , is due to the larger complexity of the room as its volume is
                                increased. Together with the constant average absorption, the reverberation time also
                                increases (Table 11.2 ). In these categories of rooms, we then compare the computation
                                times which are required to achieve a certain quality of the results (one receiver, one
                                frequency</p>
                            <h3 id="11.3-stochastic-ray-tracing-193"
                                class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.3
                                Stochastic Ray Tracing 193</h3>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Table 11.2
                                Examples of room situations</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Room 1 “
                                living ” Room 2 “ lecture ” Room 3 “ concert ” Room 4 “ church ” Volume in m 3 100 1000
                                10,000 100,000 Surface area in m 2 136 906 4725 21,733 Mean re fl ection rate in s  1
                                116 77 40 18</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Reverberation
                                time in s 0,8 1,2 2,3 5,0 Number of walls 8 20 50 100</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig. 11.19
                                Histogram result of stochastic ray tracing (absorption by annihilation), expectation
                                values and uncertainty range according to Eq. (11.29) (example)</p>
                            <div class="my-8 flex justify-center"><img src="/content/images/chapter11/11_img_19_22.jpeg"
                                    alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md"></div>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">band). At fi
                                rst, impulse responses are discussed. They may be intended either for visual inspection
                                (see Fig. 11.12 ) of the quality of the energy impulse response or as a basis for
                                further processing with the aim of auralization (see 11.9 ). The time interval in the
                                histogram is set to 10 ms. Now the type of algorithm for absorption must be chosen.
                                According to the increasing error rate illustrated in Fig. 11.19 , the energy
                                multiplication method is clearly preferable. The truncation time is set to t max ¼ T .
                                With the de fi nition of the maximum error at each time interval as 1 dB, 7 the required
                                number of rays, N , can be de fi ned and the computation times, t calc , in the
                                following table can be expected. The data, of course, only represents an order of
                                magnitude, since they strongly depend on the hardware used and on the software
                                implementation. A standard PC CPU from the year 2019 serves as an example for a rough
                                estimate. The programming language is C++ (Table 11.3 ). Next, an integral parameter
                                such as the sound level (strength G ) is the goal of the simulation. 8 Again, the limit
                                is set to 1 dB, but in this example it is related to the total energy in the impulse
                                response. The time limit of ray tracing is T /2, which is</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">7 Inspired by
                                the limit given by the jnd for sound level of roughly one decibel. 8 It is assumed that
                                the speci fi c impulse is not relevant in detail. Instead the goal of the simulation is
                                a quick estimation of the level, clarity, de fi nition or other integral parameters.</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">194 11
                                Simulation of Sound in Rooms</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Table 11.3
                                Order of magnitude of computation times in s for an expected error of 1 dB in each time
                                interval the energy impulse response (energy multiplication method), t max ¼ T</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Computation
                                time in s (Eq. 11.26 ) Room 1 “ living ” Room 2 “ lecture ” Room 3 “ concert ” Room 4 “
                                church ” N 200 2000 20,000 200,000 t calc 0.006 0.1 2 36 t calc (BSP) 0.004 0.04 0.5 6
                            </p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Table 11.4
                                Order of magnitude of computation times in ms for an expected error of 1 dB in the
                                parameter strength, G. Energy multiplication method, t max ¼ T /2</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Computation
                                time in ms (Eq. 11.26 ) Room 1 “ living ” Room 2 “ lecture ” Room 3 “ concert ” Room 4 “
                                church ” N 16 100 500 2500 t calc 0.4 3 30 260 t calc (BSP) 0.25 0.8 10 40</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Table 11.5
                                Order of magnitude of computation times in ms for an expected error of 1 dB in the
                                parameter strength, G. Annihilation method</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Computation
                                time in ms (Eq. 11.33 ) Room 1 “ living ” Room 2 “ lecture ” Room 3 “ concert ” Room 4 “
                                church ” N 31 200 1000 5000 t calc 0.001 0.1 1 10 t calc (BSP) 0.01 0.06 0.34 1.7</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">absolutely suf
                                fi cient for the determination of the total level (Eq. 11.41 ). The number of rays is
                                calculated according to Eq. ( 11.23 ). Note that computation times are now given in
                                milliseconds (Table 11.4 ). Now, the sound level (strength G) is once again the goal of
                                the simulation and the limit is set to 1 dB. This time, the annihilation method is used.
                                The required number of rays is calculated according to Eq. ( 11.30 ). No time limit such
                                as t max applies since the rays are traced to their annihilation (Table 11.5 ). Note
                                that the computation times for a detailed analysis in the impulse responses are much
                                greater than those required for integral results. In other words, integral results can
                                be estimated very quickly. For auralization purposes without reference to the speci fi c
                                room acoustic fi eld, therefore, it might be of interest to quickly estimate the room
                                acoustic parameters and to adjust arti fi cial room impulse processors of early re fl
                                ections and exponential late reverberation with reference to the integral simulation
                                results (see 16.5.3 ). Note that this type of quick parameter estimation is done best by
                                stochastic ray tracing with the annihilation method, since it offers real- time
                                capability (time limit about 50 ms; see Chap 16 ) even for large volumes such as in the
                                case of the church (room 4).</p>
                            <h3 id="11.4-image-source-model-195"
                                class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.4 Image
                                Source Model 195</h3>
                            <h3 id="11.4-image-source-model"
                                class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.4 Image
                                Source Model</h3>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">On the basis
                                of the image source principle (Sect. 4.4 ) and its extension towards geometric phase
                                superposition, the total sound pressure of direct sound and various re fl ections can be
                                modelled by adding (complex) spherical wave amplitudes. How- ever, the model is exact in
                                the case of | R | ¼ 1. For absorbing walls it is a good approximation, as long as the
                                angle of sound incidence, ϑ 0 , is small and far from a grazing incidence (see Sect. 3.3
                                ).</p>
                            <h4 id="11.4.1-classical-model"
                                class="text-xl font-semibold mt-6 mb-3 text-gray-800 dark:text-gray-200">11.4.1
                                Classical Model</h4>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">The re fl
                                ection factor is assumed to be angle-independent, corresponding to a quasi- plane wave:
                                9</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">p ¼ j ωρ 0 b
                                Qe  jkr 0 4 π r 0 þ j ωρ 0 b Qe  jkr 1 4 π r 1 R ϑ 0 ð Þ : ð 11 : 34 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">At the same
                                time it is clear that the wall must be smooth and specularly re fl ecting. From the de
                                fi nition of the single re fl ection, the image source model can be described as can be
                                seen below. For speci fi c geometries (rectangular, triangular), it has served as a
                                model for analysing the basic features of room impulse responses since the middle of the
                                last century (Cremer 1948). Then, the so-called “ Allen-Berkley/ Borish ” (Allen and
                                Berkley 1979) model was fi rst implemented by Borish (1984) in arbitrary polyhedra and
                                later used in numerous versions, not only in acoustics but also in radio wave physics
                                and in computer graphics in similar ways (Fig. 11.20 ). If the room re fl ections are
                                purely specular, the sound paths (rays) can be traced back from the receiver to the
                                source. This is achieved by using virtual (image) sources. At fi rst, they must be
                                constructed for the room of interest. The original source is mirrored at the wall
                                planes. Each image source is then mirrored at wall planes, to create image sources of
                                higher order. All permutations of the walls must be considered, except a constellation
                                involving the same wall subsequently. Under speci fi c circumstances, walls can be
                                excluded due to geometrically inconsistent ray paths (Mechel 2002). With S * denoting
                                the source position, S * n the position of the image source, n * the wall normal vector
                                ( n *   ¼ 1) and r * the vector between the foot point, A * , of the wall</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">normal and
                                source, S * , the scalar product of and yields the distance between the source and the
                                wall, d</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">9 The
                                plane-wave assumption is equivalent to the prerequisite of non-grazing sound incidence.
                            </p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">196 11
                                Simulation of Sound in Rooms</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig. 11.20
                                Image source model</p>
                            <div class="my-8 flex justify-center"><img src="/content/images/chapter11/11_img_20_25.jpeg"
                                    alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md"></div>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">d ¼ r *  n *
                                ¼ r *   cos α ð 11 : 35 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">With this
                                distance we get the position of the image source:</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">S * n ¼ S * 
                                2 d n * : ð 11 : 36 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">With this
                                procedure applied to all walls, we can construct all image sources of fi rst order.
                                Image sources of higher order are constructed in the same way by considering the fi
                                rst-order image sources as “ mother ” sources and so on. The process of mirroring is
                                continued until a certain maximum order of image sources is reached. The truncation of
                                the process is similar to the truncation of ray tracing at a maximum time, t max . Image
                                sources of n th order correspond to rays hitting n walls (Fig. 11.21 ).</p>
                            <h4 id="11.4.2-audibility-test"
                                class="text-xl font-semibold mt-6 mb-3 text-gray-800 dark:text-gray-200">11.4.2
                                Audibility Test</h4>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">With the set
                                of image sources created, a so-called audibility test must be performed. It is necessary
                                to check the relevance of each image source for the speci fi c receiver position.
                                Receivers, by the way, are points. Each image source is interpreted as the last element
                                of a chain of sources. The indices denote the series of walls hit on the path of the
                                corresponding ray, while the number of indices denotes the order of the image source. A
                                chain of i th order is</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">S ! S n 1 ! S
                                n 1 n 2 ! S n 1 n 2 ... ni  1 ! S n 1 n 2 ... ni ð 11 : 37 Þ</p>
                            <h3 id="11.4-image-source-model-197"
                                class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.4 Image
                                Source Model 197</h3>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig. 11.21
                                Construction of image sources</p>
                            <div class="my-8 flex justify-center"><img src="/content/images/chapter11/11_img_21_26.jpeg"
                                    alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md"></div>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig. 11.22
                                Image source audibility test</p>
                            <div class="my-8 flex justify-center"><img src="/content/images/chapter11/11_img_22_26.jpeg"
                                    alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md"></div>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">with n k 6¼ n
                                k  1 counting the walls hit, n k 2 (1, n w ). The audibility test is started at the
                                receiver point, and the ray is traced back from this point to the source along the chain
                                of image sources. As an example, Fig. 11.22 shows the determination of audible image
                                sources up to the second re fl ection order. The current receiver point is connected
                                with the image source under test, S 12 . The last index indicates that wall 2 was the
                                last to be hit. If the intersection point of the straight line with the wall polygon 2,
                                RS 12 , is inside the polygon, the result is preliminary positive. We then continue with
                                drawing a line from the intersection point to the mother source 10 of S 12 , S 1 . This
                                procedure is repeated until the original source is reached. If all intersections hit
                                inside the</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">10 A mother
                                source is the source located in the chain as predecessor.</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">198 11
                                Simulation of Sound in Rooms</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">polygons, the
                                image source (in this case S 12 ) is in fact audible from the receiver point R. Note
                                that S 21 is not audible from R since P is outside wall polygon 1. But it would be
                                audible from R´. Thus, each source must be tested speci fi cally in relation to the
                                receiver. Also, the fact that one image source is audible cannot be generalized for its
                                predecessors. It should be noted, too, that the crucial test of this procedure is the
                                point-in-polygon test, like in ray tracing. All strategies to accelerate the
                                back-tracing procedure by spatial substructures may therefore be applied as well. For
                                audible image sources, the complex amplitudes are stored in the sound pressure impulse
                                response. The delay of the impulse related to each image source is calculated from the
                                distance between the image source and the receiver, r IS .</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Y i</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">p IS ¼ j ωρ 0
                                b Q e  j ω t IS 4 π crt IS</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">R n ð 11 : 38
                                Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">n ¼ 1</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">with t IS ¼ r
                                IS / c and R n being the re fl ection factors of the walls involved in the respective
                                chain source. No time intervals are required at this stage of processing. The temporal
                                resolution can be in fi nitely high, and the sampling rate can thus be freely de fi ned.
                                An estimation of the re fl ection factor from the absorption coef fi cient can be done
                                straightforward by using</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">R j j ¼
                                ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 1  α p ð 11 : 39 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">and an
                                appropriate phase. Rindel (1993) and Mommertz (1996) show that absorption coef fi cients
                                in one-third octave bands serve well for reconstructing the complex re fl ection factor.
                                Minimum or linear phases are options for the phase function, to be reconstructed, for
                                instance, from Hilbert transformation.</p>
                            <h4 id="11.4.3-limitations"
                                class="text-xl font-semibold mt-6 mb-3 text-gray-800 dark:text-gray-200">11.4.3
                                Limitations</h4>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Truncation The
                                image source model is a strictly deterministic method. Uncertainties are caused by the
                                prerequisite of geometrical acoustics and by the necessary truncation of the image
                                source of a certain order. Although not explicitly implemented, an average maximum time,
                                t max , has to be taken into account. The maximum order is related to the computation
                                time, which is more crucial than in the case of ray tracing. This fact is due to the
                                dramatic increase of the number of sources which need to be treated with higher orders.
                                11 The number of audible sources, however, just increases with t 3</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">in the impulse
                                response (Cremer 1948).</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">11 Without
                                strategies for excluding sources for geometric reasons, the increase is exponential.</p>
                            <h3 id="11.4-image-source-model-199"
                                class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.4 Image
                                Source Model 199</h3>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">At higher
                                orders of image sources, the ratio between constructed and visible sources is absolutely
                                uneconomic. With i denoting the chosen maximum order, the trunca- tion time is</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">t max ¼ i = 
                                n ð 11 : 40 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">and the energy
                                missing is</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">w trunc w h i
                                ¼ 1  α ð Þ i : ð 11 : 41 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">The
                                computation time, t calc , is similarly estimated from the time required for the
                                point-in-polygon test (Eqs. 11.22 and 11.23 ):</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">t calc ¼ τ ∙ N
                                IS ð 11 : 42 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">The classical
                                (Allen-Berkley / Borish) image source model is thus applicable and ef fi cient for the
                                following cases:</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">– For short
                                impulse responses (second or third order) – For simple geometries (small n w ) – For
                                rectangular rooms (since the audibility test can be omitted) 12</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Spherical
                                Waves at Grazing Incidence Another limitation is given by the validity of Eq. ( 11.34 ).
                                The re fl ection coef fi cient R ( ϑ 0 ) 6¼ 1 in the contribution of the image source
                                implies a constant angle of incidence and thus a re fl ection of a plane wave at one re
                                fl ection point. This assumption is well suited when a spherical wave 13 is considered
                                with a large distance between the source and the receiver at the wall.</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">At smaller
                                distances and corresponding grazing incidence, Eq. ( 11.34 ) carries a non-determined
                                uncertainty. It would then be necessary to calculate the re fl ected wave in the more
                                general form. Generally, the sound pressure at the receiver point is given by</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">p ¼ j ωρ 0 b
                                Qe  jkr 0 4 π r 0 þ p IS , ð 11 : 43 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">whereas the
                                standard model offers an estimate equation</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">12 For a
                                rectangular room, a regular lattice of image sources applies, with multiple sources (of
                                indices in permutated order) coinciding at the lattice points. It can be shown, however,
                                that for every receiver point exactly one lattice source is audible. 13 Relevant here is
                                the temporal coincidence of the wavefront phases hitting the surface.</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">200 11
                                Simulation of Sound in Rooms</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">p IS,plane
                                wave ¼ j ωρ 0 b Qe  jkr 1 4 π r 1 R ϑ 0 ð Þ ð 11 : 44 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">with</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">R ϑ 0 ð Þ ¼ ζ
                                cos ϑ 0  1 ζ cos ϑ 0 þ 1 : ð 11 : 45 Þ</p>
                            <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">It includes
                                the speci fi c wall impedance, ζ for locally reacting surfaces. The exact solution
                                accounts for spherical wave propagation following Eq. ( 3.17 ). The errors introduced by
                                the plane-wave assumption for impedance and re fl ection factor have been investigated
                                both by experiment and by fi eld calculation (Suh and Nelson 1999). As a rule of thumb,
                                we should remember that at grazing incidence ( ϑ 0 > 60 degrees) and at too close
                                distances, d , of receiver and source to the wall ( d  λ ) systematic uncertainties of
                                sound pressure, Δ p which are clearly audible ( Δ p IS > 20%, which corresponds to 1 dB)
                                must be considered. In the middle of a room, errors are smaller than at positions near
                                the room ’ s boundaries. Small- and medium-size rooms (50 m 3 < V < 200 m 3 ) at low
                                    frequencies ( f < 200 Hz), however, hardly have a centre area which is further away
                                    from the boundaries than a wave- length. Here, the validity of standard (i.e.
                                    plane-wave impedance) geometrical acoustics is at its limits. A more speci fi c and
                                    precise uncertainty of the auralization result cannot be predicted, since the
                                    simulation errors in the end depend not only on the room but on the type of signal.
                                    A pure tone simulation is by far more delicate than a broadband simulation over
                                    several critical bands. The fact that walls are not locally reacting at low
                                    frequencies and that the impedance may be distributed over the entire wall (by
                                    distributed screws in studs, for instance) creates further complications.</p>
                                    <h4 id="11.4.4-diffraction"
                                        class="text-xl font-semibold mt-6 mb-3 text-gray-800 dark:text-gray-200">11.4.4
                                        Diffraction</h4>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">In the
                                        classical image source model (and also in ray tracing), diffraction is
                                        neglected. In room acoustics diffraction may happen for two reasons: there can
                                        be obstacles in the room space (e.g. stage re fl ectors), or there can be edges
                                        at the surroundings of the fi nite room boundaries. In the latter case, either
                                        the boundary is forming an obstacle, such as columns or the edge of an orchestra
                                        pit, or the boundary is forming the edge between different materials with
                                        different impedances (and absorption). Since dif- fraction is a typical wave
                                        phenomenon, it is not included in the basic simulation algorithms listed above.
                                        In the past, there were some ideas of including diffraction as a statistical
                                        feature into acoustic ray models. But the success was quite limited because the
                                        increase in calculation time is a severe problem (Fig. 11.23 ). In optics and
                                        radio wave physics, however, ray tracing models were generalized in the uniform
                                        geometrical diffraction theory, UDT (Kouyoumjian and Pathak 1974;</p>
                                    <h3 id="11.4-image-source-model-201"
                                        class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.4
                                        Image Source Model 201</h3>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.23 Geometric edge diffraction using secondary sources. (After Svensson et al.
                                        1999)</p>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_23_30.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_24_30.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.24 Ray (particle) diffraction model. (After Stephenson 2004b)</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        Tsingos et al. 2001). Other approaches were presented by Svensson et al. (1999),
                                        who applied the model developed by Biot and Tolstoy (1957) to acoustic problems.
                                        These approaches are very powerful for the determination of fi rst- or
                                        second-order diffraction. But all methods of geometrical diffraction are very
                                        time-consuming for the simulation of a multiple-order diffraction and
                                        corresponding reverberation, and they also introduce ray-splitting and an
                                        exponential factor in the multiple-scattering algorithm. Another possibility is
                                        to apply the fi nite element or boundary element methods, of course. Stephenson
                                        (2004a, b) developed two approaches for edge diffraction. One consists of the
                                        implementation of “ virtual fl ags ” mounted at the edge, which let the edges
                                        affect rays in the room interior (Fig. 11.24 ). The fl ag ’ s width is about one
                                        wavelength representing the midband frequency of the octave or one-third octave
                                        band. Rays hitting the fl ags can be diffracted according to the statistical
                                        distribution of diffraction angles depending on the distance from the edge, the
                                        wavelength and the ray incidence angle. This distribution is derived from either
                                        slit diffraction models or Fresnel ’ s edge diffraction models.</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">202 11
                                        Simulation of Sound in Rooms</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Both
                                        methods show good results in case studies, but they are, however, not perfect in
                                        the variety of all general cases in practice. Diffraction models and their
                                        implementation in image source and ray tracing algorithms will be one of the
                                        greatest challenges in future developments of geomet- rical room acoustic
                                        simulation methods.</p>
                                    <h4 id="11.4.5-reduction-of-computational-load-by-preprocessing"
                                        class="text-xl font-semibold mt-6 mb-3 text-gray-800 dark:text-gray-200">11.4.5
                                        Reduction of Computational Load by Preprocessing</h4>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Field
                                        Angle Geometric tests help to reduce the computational load to create and check
                                        the audibility of image sources. If inconsistent sources are found, construction
                                        of daughter sources can be avoided. Mechel (2002) de fi nes the fi eld angle
                                        which is valid for each image source. If the receiver is not located in the fi
                                        eld angle, the source is inaudible. Now, if a wall polygon to be used for
                                        creation of the daughter source (see 11.4.1 ) is outside the fi eld angle, the
                                        mother source cannot give birth to this daughter. In the example in Fig. 11.25 ,
                                        it is illustrated that the image source S 70 (the daughter of source S 0 and
                                        granddaughter of S) spans a fi eld angle with the “ father ” wall no 7.
                                        Receivers outside the fi eld angle do not receive sound from S 70 . Further-
                                        more, in this example a convex corner situation is present and, thus, the fi eld
                                        angle is affected by a shadow region.</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">With
                                        these and other criteria, strategies for interrupting the creation of image
                                        sources can be reduced signi fi cantly (Mechel 2002).</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        Spatial Data Structures Spatial data structures have been commonly used in
                                        applications of computer graphics and have already been applied in room
                                        acoustics simulation algorithms (see Funkhouser et al. 1998; Jedrzejewski and
                                        Marasek 2004).</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        Different types of spatial data structures are in use, such as bounding volume
                                        hierarchies, binary space partitioning (BSP) trees and octrees. They all have in
                                        common that the entire geometry is subdivided into smaller subspaces, which are
                                        encoded in the data structure. In contrast to bounding volume hierarchies, which
                                    </p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.25 Field angle of image source S 70 (re fl ection path with walls 0 and 7)
                                    </p>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_25_31.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <h3 id="11.4-image-source-model-203"
                                        class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.4
                                        Image Source Model 203</h3>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        separate the scenery into single objects enclosed by bounding volumes like
                                        spheres or boxes, BSP and octrees subdivide the scenery into subspaces without
                                        taking into account any information about single objects. Octrees divide the
                                        scenery regularly along all three axes. Hence, every division of space results
                                        in eight new boxes. BSP trees allow a fl exible partitioning of space by means
                                        of arbitrary-shaped partitioners. Both methods satisfy the same type of queries.
                                        For simple intersection tests, the BSP structure is more appropriate than
                                        octrees due to its higher fl exibility. Spatial subdivision helps to speed up
                                        the required intersection tests, the fast point- in-polygon test and an ef fi
                                        cient data structure with respect to real-time auralization in order to provide
                                        a faster determination of the BRIR. This goal is illustrated further by
                                        discussing the example of BSP (Shumacker et al. 1969).</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Binary
                                        Space Partitioning The aim of BSP is speeding up the determination of the
                                        location of an arbitrary point relative to a geometrical scene, which is encoded
                                        by a so-called BSP tree.</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">It is
                                        preferable to use planes spanned by polygons as partitioners (Fig. 11.26 ). Each
                                        tree node contains one partitioner that divides the current subspace into two
                                        smaller subspaces. In the problem of fi nding the next re fl ection point, the
                                        point in question can have three possible relative locations: (1) on, (2) in
                                        front of, and (3) behind the partitioner. In the fi rst case, the query can be
                                        stopped. To pursue the latter two cases, the test is continued by branching to
                                        the respective son of the node, left for “ behind ” and right for “ in front ” .
                                        The tree ’ s root node therefore refers to the whole space, while leaf nodes
                                        refer to a subspace which does not contain any further scene detail. Contrary to
                                        the naive approach to test the position of the point against all planes, the
                                        tree structure allows the determination of the position by testing only a subset
                                        of planes. This subset is de fi ned by the path in the tree. By using a balanced
                                        tree, i.e. a tree of minimum height, the number of tests can also be minimized,
                                        which drops the complexity from O( N ) to O(log 2 N ), where N is the number of
                                        polygons.</p>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_26_32.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.26 Example of a BSP tree for a given room geometry. (After Shumacker et al.
                                        1969; Schröder and Lentz 2006)</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">204 11
                                        Simulation of Sound in Rooms</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Voxels
                                        Like octrees, voxels are volume boxes. They are created to subdivide the actual
                                        room volume, for example, by using cubes. In one pass of preprocessing, it is
                                        tested for each voxel with which walls it intersects. Later, in the ray tracing
                                        process or visibility test, we look for the next intersection point with a
                                        polygon. This test can be speeded up by not testing the complete set of polygons
                                        but only polygons in voxels along the straight line representing the ray or
                                        image path. Stephenson (2006) derived an analytic equation for the gain in
                                        computation which results to</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">t calc
                                        j voxel / ﬃﬃﬃﬃ n w p , ð 11 : 46 Þ</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">which
                                        was a previously linear increase without using voxels (Eq. 11.24 ).</p>
                                    <h3 id="11.5-hybrid-image-source-models-(deterministic-ray-tracing)"
                                        class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.5
                                        Hybrid Image Source Models (Deterministic Ray Tracing)</h3>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Ray
                                        tracing and image source algorithms have opposite advantages and disadvan-
                                        tages. Therefore it is worthwhile to develop a combination of both in order to
                                        obtain:</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">– Fine
                                        temporal resolution in the sampling rate quality – Inclusion of scattering –
                                        Faster audibility check of image sources</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">This
                                        kind of combination is called “ hybrid method ” . The term “ ray tracing ” is
                                        also in use, however, somewhat confusing with the stochastic ray tracing
                                        described above. The key to combine the methods is the audibility test of image
                                        sources in the forward direction.</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">If we
                                        run a specular ray tracing process and fi nd a receiver hit by a ray, the
                                        corresponding image source must be audible.</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        Variants of this approach are often summarized as “ ray tracing ” . Speci fi c
                                        algo- rithms are also known as “ cone tracing ” , “ beam tracing ” , “ pyramid
                                        tracing ” , etc. What all have in common is the idea of a forward audibility
                                        test of specular re fl ections, represented physically by image sources. The
                                        speci fi c physical reason is the fact that the energy contributions of the re
                                        fl ections are calculated by using Eq. ( 11.38 ). The main difference between
                                        this type of ray tracing and the previously discussed stochastic ray tracing
                                        method is the way of detecting sound energy (Fig. 11.27 ).</p>
                                    <h3 id="11.5-hybrid-image-source-models-(deterministic-ray-tracing)-205"
                                        class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.5
                                        Hybrid Image Source Models (Deterministic Ray Tracing) 205</h3>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_27_34.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.27 Energy detection in stochastic (left) and deterministic (right) ray
                                        tracing</p>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_28_34.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.28 Cone (left) and pyramid (right) tracing</p>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_29_34.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.29 Geometry of source, cone and receiver</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Of
                                        course, in a running ray tracing process, rays hitting the receiver can have the
                                        same history of wall re fl ections. In this case we observe an energetic overlap
                                        between rays, and it must be ensured that each image-source-based re fl ection
                                        is counted just once, for instance, by checking the indices in the wall list.
                                        Exactly this point is the reason for the differences in the variants listed
                                        above. In the various concepts, rays are extended towards geometrically
                                        diverging objects like cones or pyramids (Fig. 11.28 ). This way it is also
                                        ensured that image source contributions are counted only once. While cone or
                                        beam tracing still create slight problems with overlap (Vian and van Maercke
                                        1986), pyramid tracing which uses the wall polygons as pyramid bases avoids
                                        double counts (Stephenson 2004b). At the same time, point-like receiver can be
                                        because of extended and diverging ray geometries. The required number of rays or
                                        cones depends on the maximum distance between the image source and the receiver
                                        and therefore on the order of the image source and the corresponding average
                                        delay in the impulse response, as illustrated with the example of a cone (Fig.
                                        11.29 ).</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">206 11
                                        Simulation of Sound in Rooms</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.30 Computation times of room acoustic simulation algorithms (example)</p>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_30_35.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">The fi
                                        gure shows the path between image source and receiver in an expanded version. 14
                                        N cones are started into the full space of 4 π . From these</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">k ¼ N
                                        Ω = 4 π ð 11 : 47 Þ</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">will
                                        hit the receiver, with Ω denoting the spatial angle of the cone:</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Ω r 2
                                        ¼ π r 2 d ð 11 : 48 Þ</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">for r
                                        » r d . Hence the probability of cones hitting the receiver is</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">k ¼ Nr
                                        2 d 4 r 2 ¼ Nr 2 d 4 ct ð Þ 2 : ð 11 : 49 Þ</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">To
                                        ensure at least one ( k ¼ 1) cone hitting the receiver after a time t max</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">N min
                                        ¼ 4 ct max ð Þ 2</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">r 2 d
                                        : ð 11 : 50 Þ</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">The
                                        computation time of this kind of ray tracing (see also Eq. 11.26 )</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">t calc
                                        ¼ 4 c 2 nt 3 max r 2 d τ , ð 11 : 51 Þ</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        increases with the third power of the impulse response length (Figs. 11.30 and
                                        11.31 ).</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">14 The
                                        real path is folded from re fl ection to re fl ection. The total path length is
                                        identical in the expanded version.</p>
                                    <h3 id="11.6-systematic-uncertainties-of-geometrical-acoustics-207"
                                        class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.6
                                        Systematic Uncertainties of Geometrical Acoustics 207</h3>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.31 Results of a hybrid image source algorithm</p>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_31_36.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">In the
                                        last decades, several authors presented strategies to fi ght against the
                                        computational load of the image source method (Mechel 2002; Funkhouser et al.
                                        1999; Stephenson 2004a). Other authors presented interesting approaches for gen-
                                        eralizing the image source principle with regard to diffraction and scattering
                                        (Martin and Guignard 2006). It should be stressed again that the standard image
                                        source method is based on non-absorptive walls or, at least, on absorption in
                                        the plane-wave approximation. Approaches of extensions which do not consider
                                        wave theoretical extensions still suffer from limits set by the theory of
                                        specular re fl ections. Before we will focus on strategies for speeding up the
                                        simulation algorithms for auralization, the physical limits of room acoustics
                                        simulation by ray tracing and image sources should be discussed. Uncertainties
                                        of simulation methods applied in practice were checked and documented. The basic
                                        material data available and the necessary psychoacoustical rating of the results
                                        are also important and need to be considered.</p>
                                    <h3 id="11.6-systematic-uncertainties-of-geometrical-acoustics"
                                        class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.6
                                        Systematic Uncertainties of Geometrical Acoustics</h3>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        Geometrical acoustics (ray tracing, image sources) allows simulation of sound fi
                                        elds in rooms and outdoors. These models yield correct results under speci fi c
                                        circum- stances (mostly academic cases) and then ful fi l the wave equation. But
                                        absolute physical correctness is not always a reasonable goal. In by far the
                                        most cases,</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">208 11
                                        Simulation of Sound in Rooms</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.32 Round robin I, PTB auditorium (Vorländer 1995). Reverberation times
                                        calculated and measured (thick line) for source/ receiver combinations</p>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_32_37.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        geometrical acoustics offers approximate solutions, solutions which are
                                        absolutely suf fi cient in practice. But it should be kept in mind that the
                                        limits are:</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">–
                                        Large rooms, non-grazing incidence 15</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">–
                                        Curved surfaces, focusing (Vercammen 2010) – Low absorption coef fi cients –
                                        Broadband signals</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Room
                                        acoustical results like reverberation time, clarity, strength, etc. are usually
                                        expressed in relation to frequency bands. The reason for using frequency bands
                                        is that sound signals related to room acoustics are of broadband character, like
                                        speech and music. Also, from a physiological point of view, one-third octave
                                        bands are a good compromise since they are an approximation for critical bands
                                        (Sect. 6.3.1 ). These arguments are the justi fi cation for using energetic
                                        methods (neglecting phases). At low frequencies, however, the situation is
                                        different. Transmission of pure tones, possibly the fundamental frequency of
                                        musical instruments, is surely of interest in optimizing the placement of
                                        recording arrangements in studios or in fi nding the optimal loudspeaker
                                        positions. Simulation and auralization of harmonic signals in such cases may
                                        largely differ from the sound pressure in the real case. In 1995, room
                                        simulation software solutions were tested in an international round robin
                                        project. Eight parameters de fi ned in ISO 3382 ( T , EDT, D , C , T S , G , LF
                                        and LFC) were calculated at two source positions and fi ve receiver positions in
                                        a test room. 16 The results were compared with measurement results, at fi rst
                                        only in one frequency band (1 kHz) (Fig. 11.32 ). The simulated reverberation
                                        time results of the fi rst phase of the project were generally too large, thus
                                        indicating that the users underestimated absorption. Then, after performing
                                        measurements, the absorption coef fi cients were published, and the</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">15 or
                                        tangential modes. 16 Auditorium of the Physikalisch-Technische Bundesanstalt,
                                        Braunschweig, Germany.</p>
                                    <h3 id="11.6-systematic-uncertainties-of-geometrical-acoustics-209"
                                        class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.6
                                        Systematic Uncertainties of Geometrical Acoustics 209</h3>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.33 Overall results of the “ round robin I ” (Vorländer 1995). The ordinate
                                        scale refers to a normalized deviation from the jnd (At that time the jnd for
                                        clarity was assumed to be round 0.5 dB. Later it was shown that 1 dB is a better
                                        approximation; see also Table 6.1 )</p>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_33_38.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        software was run again with harmonized input data. The agreement was much
                                        better, of course, but now the ef fi ciency of the software could clearly be
                                        identi fi ed. The overall accuracy of the computer simulations can be estimated
                                        by a single number rating. This quantity is de fi ned by using the absolute
                                        difference between the result from the simulation and the measurement on each of
                                        the ten source and receiver combinations. The average of these
                                        location-dependent differences is then related to the jnd for the respective
                                        acoustic criterion. The resulting relative error for each acoustical parameter
                                        is shown in Fig. 11.33 . Note that a value of 1 indicates the order of magnitude
                                        of the jnd. Only 3 out of 17 programmes could deliver results of similar
                                        accuracy, which is given by the standard deviation of the measurements and by
                                        the just noticeable differences (Table 6.1 ). In the second intercomparison
                                        project, Bork (2000a) investigated the results of simulations in a larger room
                                        and for more frequency bands. The example room was the ELMIA hall in Jönköping,
                                        Sweden. The intervals of the jnd related to the speci fi c psychoacoustic
                                        dimensions were re fi ned. The results generally supported the con- clusion from
                                        3 years before, namely, that simulation algorithms require a module for the
                                        treatment of scattering. Also, in the second project, one CAD room model was
                                        provided in order to run software with identical input data. Finally the third
                                        round robin was focused on a smaller room with expected modal effects. The
                                        results again support the fact that (a) a good scattering model is essential and
                                        (b) the overall prognosis accuracy, when results are compared with experimental
                                        results, can be in the range of 1 to 2 jnd. For achieving this accuracy,
                                        programmes are available, so that a certain quality of the results can be
                                        guaranteed. The operator of the software, however, still has crucial in fl uence
                                        on the choice of absorption and scattering coef fi cients. After all, room
                                        acoustical computer simulation has been proven to yield reliable results.
                                        Scattering was identi fi ed as an important factor. With careful data choice of
                                        absorption and scattering coef fi cients, it is possible to obtain good
                                        prediction results which deviate from the experimental result in the same order
                                        of magnitude as the uncertainty of the experiment or the jnd.</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">210 11
                                        Simulation of Sound in Rooms</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">More
                                        information about open data and open-source software including intercom-
                                        parisons and benchmarks in computational acoustics is given in Sect. 18.5 .</p>
                                    <h3 id="11.7-hybrid-models-in-room-acoustics"
                                        class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.7
                                        Hybrid Models in Room Acoustics</h3>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        Deterministic models like the image source model suffer from inherent systematic
                                        errors and from limitations in the software implementation. Stochastic models
                                        suffer from poor temporal resolution, but they can handle scattering. Impulse
                                        responses from image-like models consist of Dirac pulses arranged according to
                                        their delay and amplitude and sampled with certain temporal resolution. However,
                                        in the intercomparison of simulation programmes (see 11.6 ), it soon became
                                        clear that pure image source modelling will create too rough an approximation of
                                        physical sound fi elds in rooms, since a very important aspect of room acoustics
                                        – surface and obstacle scattering – is neglected. This fact is further supported
                                        by the observation that scattered energy will dominate the reverberation process
                                        after a few re fl ections (order 3 or 4), even in rooms with rather smooth
                                        surfaces (see Fig. 11.34 and Kuttruff (1995)). Also, the audibility of
                                        characteristics of diffuse re fl ections was proven by (Torres et al. 2002).
                                        Fortunately, the particular directional distribution of scattered sound is not
                                        rele- vant in the fi rst place and can well be assumed as Lambert scattering.
                                        Solutions to the problem of surface scattering are given by either stochastic
                                        ray tracing or radiosity. Another effect of wave physics – diffraction – can be
                                        introduced into geometrical acoustics in principle. Big problems, however, arise
                                        from extending diffraction models to higher orders (Svensson et al. 1999). Thus,
                                        in applications other than in</p>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_34_39.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.34 Conversion of specularly into diffusely re fl ected sound energy,
                                        illustrated by an example. (After Kuttruff 1995)</p>
                                    <h3 id="11.7-hybrid-models-in-room-acoustics-211"
                                        class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.7
                                        Hybrid Models in Room Acoustics 211</h3>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        outdoor noise propagation, 17 diffraction models have not yet been implemented.
                                        New algorithmic schemes, like the one presented by Stephenson (2004b), have not
                                        yet been implemented either. It should be mentioned here that until today
                                        numerous algorithmic details have been published in the fi eld of wave fi eld
                                        simulation. Sound transmission and diffraction, too, must be implemented in
                                        cases of coupled rooms or in room-to-room transmission; see Chap 12 .</p>
                                    <h4 id="11.7.1-hybrid-deterministic-stochastic-models"
                                        class="text-xl font-semibold mt-6 mb-3 text-gray-800 dark:text-gray-200">11.7.1
                                        Hybrid Deterministic-Stochastic Models</h4>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">The
                                        general principles of room acoustic modelling were discussed in the previous
                                        sections. They yield results of high temporal resolution (in scales of μ s),
                                        typically represented by re fl ections of directly used or implicitly involved
                                        image sources. Due to numerical constraints and also due the fact that it is
                                        unnecessary to create such a high resolution for the late reverberation (>100
                                        ms), stochastic methods like ray tracing and radiosity now move into the focus
                                        of our interest. It is obvious to combine the tedious but exact deterministic
                                        methods with a quick estimation of the reverberation tail. In the following,
                                        some well-known software solutions are brie fl y discussed. This overview is not
                                        intended to cover all kind of software used today. The particular examples
                                        listed here represent the historic process of software development for room
                                        acoustic computer simulation using hybrid models in the 1990s.</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        CATT-Acoustic In his thesis, Dalenbäck (1995) studied aspects of an extended
                                        radiosity approach merged with specular re fl ection techniques (see also
                                        Dalenbäck 1996). The imple- mentation of the software had already been started
                                        in the late 1980s and has continuously been improved and extended. The main
                                        model is based on predicting high-order re fl ections using randomized
                                        tail-corrected cone-tracing and direct sound, fi rst-order specular and diffuse
                                        and second-order specular-to-specular re fl ections. The re fl ections are
                                        created using deterministic methods and image sources with full temporal
                                        resolution and bandwidth. Higher-order re fl ections are the result of inde-
                                        pendent ray/cone-tracing for each octave-band taking into account the frequency
                                        dependence of diffuse re fl ections via randomly selecting specular or diffuse
                                        via the scattering coef fi cient magnitude where a diffuse ray is re fl ected
                                        using the Lambert distribution. Dalenbäck and McGrath (1995) also presented
                                        tools for dynamic auralization using headphones with head tracking already in
                                        1995 (Fig. 11.35 ). 18</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">ODEON
                                        The fi rst version of ODEON was published in (Naylor 1993). It is a hybrid image
                                        source model with a stochastic scattering process which uses secondary sources.
                                        The</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">17
                                        Almost free- fi eld propagation with at most one diffraction edge. 18
                                        www.catt.se</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">212 11
                                        Simulation of Sound in Rooms</p>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_35_41.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.35 Scattered energy radiated from surface patches in CATT. ( a ) First-order
                                        diffuse and specular re fl ections, ( b ) fi rst-order diffuse re fl ections, (
                                        c ) schematic echogram at receiver 1 (direct sound omitted), ( d ) schematic
                                        echogram at receiver 2 (direct sound omitted)</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        secondary sources are assigned a frequency-dependent directionality, the
                                        so-called re fl ection-based scattering coef fi cient. This implies that the
                                        direction of the ray that created the secondary source is taken into account.
                                        The polar scattering patterns are created from a vector-based process which adds
                                        Snell ’ s (specular) and Lambert ’ s (diffuse) scattering into one fi nal
                                        scattering direction for each ray (Rindel and Christensen 2003). 19 The creation
                                        process of secondary sources is shown in Fig. 11.36 (top) for the example of one
                                        single ray. The irradiation of sound from the secondary sources to a receiver is
                                        shown in Fig. 11.36 (bottom) for the example of a receiver on the fi rst
                                        balcony. Some of the secondary sources cannot contribute to this receiver due to
                                        the audibility check.</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">QPBT
                                        QPBT is the abbreviation for Quantized Pyramidal Beam Tracing (Stephenson 1996,
                                        2004a). The geometric principle of the method is pyramidal beam tracing on the
                                        basis of the wall polygons which form the pyramidal base area. Successive re fl
                                        ec- tions are created by extending and splitting the pyramids towards the other
                                        wall polygons. The problem of exponential increase of pyramids is inherent in
                                        the geometric imaging method. In QPBT, this is solved by the uni fi cation of
                                        spatially</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">19
                                        http://www.odeon.dk</p>
                                    <h3 id="11.7-hybrid-models-in-room-acoustics-213"
                                        class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.7
                                        Hybrid Models in Room Acoustics 213</h3>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.36 Secondary source model in ODEON. (After Rindel 1993). S is the source, R
                                        the receiver point. Top, creation of secondary sources; bottom, only the
                                        secondary sources with free line-of-sight contribute to the sound pressure at
                                        the receiver on the balcony</p>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_36_42.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        closely located pyramids. Furthermore, by also discretizing the time frame, it
                                        is possible to recombine sound energy into fi nite elements of time and spatial
                                        angle. The particular way of energy travelling via a pyramid to the discrete
                                        element is irrelevant. The model is thus open for inclusion of scattering and
                                        edge diffraction. In which way edge diffraction is implemented best in the
                                        pyramidal beam has actually been tested in Stephenson and Svensson (2007) (Fig.
                                        11.37 ).</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">EASE
                                        The software EASE stems from the application of simulating installations of pro-
                                        fessional audio and sound reinforcement systems (Ahnert and Feistel 1993). 20
                                        The database of loudspeaker frequency responses and directivities is hence very
                                        large, and it includes innovative approaches for detailed and accurate
                                        loudspeaker repre- sentation. It was fi rst implemented in an image source model
                                        capable of simulating particularly the direct sound and the early response in
                                        particular.</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">In a
                                        later version of EASE, the room acoustic simulation was extended by integrating
                                        elements from a hybrid image source/ray tracing model called “ CAE- SAR ”
                                        (Vorländer 1989; Schmitz et al. 2001). The key of the latter method is the
                                        parallel running of image source and ray tracing algorithm which delivers the
                                        specular re fl ections precisely and the diffuse re fl ections via the
                                        stochastic approach</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">20
                                        http://www.ada-acousticdesign.de/set_en/setsoft.html</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">214 11
                                        Simulation of Sound in Rooms</p>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_37_43.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.37 Quantized Pyramidal Beam Tracing and corresponding pyramid tree. (After
                                        Stephen- son 1996)</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.38 Diffuse rain implemented for calculating the portion of scattered energy
                                        to a detector sphere (see (Heinz 1993) or the recently extended version in
                                        (Schröder et al. 2007), see also Fig. 16.7 )</p>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_38_43.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">( “
                                        diffuse rain ” after Heinz (1993)) with lower spectral and temporal resolution
                                        in the reverberation tail. The main feature of this method is a closed solution
                                        of an inherent transition from early specular to late specular/diffuse re fl
                                        ections. It is not required to de fi ne transition orders or secondary sources
                                        (Fig. 11.38 ).</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">RAVEN
                                        SketchUp Plugin The room acoustics simulation module called RAVEN (Room
                                        Acoustics for Virtual Environments) is implemented as an C++ library (Pelzer et
                                        al. 2014). It is available in open access for educational purposes.</p>
                                    <h3 id="11.7-hybrid-models-in-room-acoustics-215"
                                        class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.7
                                        Hybrid Models in Room Acoustics 215</h3>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_39_44.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.39 RAVEN SketchUp plugin. (Vorländer et al. 2015)</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">RAVEN
                                        includes several optimization techniques such as multi-core parallelization and
                                        utilization of extended instruction sets. This makes it a high- performance
                                        library that can take advantage of the full computation power of modern CPUs.
                                        The most time-consuming part of the simulation is the ray tracing component,
                                        which takes some seconds of computation time, of course depending on the amount
                                        of required rays and the complexity of the room model. The calculation time can
                                        be reduced signi fi cantly by distributing the workload to two or more parallel
                                        threads, e.g. on a multi-core CPU. In order to constantly transfer the room
                                        model from the 3D modelling GUI to the acoustics simulation environment, a
                                        plug-in was developed and integrated into the 3D modeller “ SketchUp ” with full
                                        interactivity. Modi fi ca- tions in the model geometry or in the material
                                        properties are processed and auralized immediately. For the early part of the
                                        response, which is calculated by image sources, the update rate ful fi ls
                                        real-time performance, while the late response is updated in the order of
                                        magnitude of seconds (Vorländer et al. 2015) (Fig. 11.39 ).</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">State
                                        of the Art Still today, the programmes listed above are subject to permanent
                                        development, not only concerning the component of impulse response computation
                                        but also other elements such as source and material databases. Most of them also
                                        offer signal processing tools, visualization tools and auralization tools in
                                        various reproduction formats.</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">216 11
                                        Simulation of Sound in Rooms</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        Algorithms of geometric room acoustics modelling were also published by Farina
                                        (1995), Alarcão and Bento Coelho (2003), Lokki (2002) and Camilo et al. (2002),
                                        besides others. Many of these programmes were inspired by Kulowski (1985),
                                        Stephenson (1985), Vian and van Maercke (1986), Vorländer (1989) and Lewers
                                        (1993). In some methods, it was tried to build room impulse responses from re fl
                                        ection statistics (Vorländer 2000; Bento Coelho et al. 2001). Due to the rapid
                                        development in acoustic room simulation, however, this list cannot be complete;
                                        see also the excellent overview in Savioja and Svensson (2015). State-of-the-art
                                        room-acoustic simulation is still based on geometrical acoustics. Wave models,
                                        however, are catching up. They require computation times which are higher by
                                        orders of magnitude, but their application is well possible for a limited
                                        frequency range.</p>
                                    <h3 id="11.8-hybrid-wave-and-geometrical-acoustics-models"
                                        class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.8
                                        Hybrid Wave and Geometrical Acoustics Models</h3>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        According to the particle-wave dualism, acoustic room responses can be
                                        calculated both ways, with geometrical acoustics and with wave models (see Sect.
                                        10.2 ). For small rooms and for objects in the room which cause explicit wave
                                        effects, geomet- rical methods cannot produce accurate results. This may apply
                                        to columns in the interior space, to the edge of an orchestra pit in an opera
                                        house or to the seat-dip effect in concert halls. The simple reason for the
                                        latter example is that the seats and the audience are not small compared with
                                        all wavelengths in the audio frequency range. For 100 – 200 Hz, where the
                                        seat-dip effect occurs, full wave-based models must then be chosen. Due to
                                        limitations of computation speed, maximum mesh sizes and memory space, however,
                                        the wave models are limited at higher frequencies. Hence, combinations of wave
                                        models with geometrical acoustics models were introduced (Kleiner et al. 1995;
                                        Summers et al. 2004). This is where the fi nite element method, FEM, the
                                        boundary element method, BEM, and the method of fi nite differences in time
                                        domain, FDTD, come into play. Wave-based simulations can yield results between
                                        lowest frequencies to up to above the Schroeder frequency (Savioja 2010;
                                        Hamilton and Bilbao 2017; Hargreaves et al. 2019), so that an overlap in
                                        frequency range with results from geometrical acoustics can well be achieved.
                                        The results are then merged in a crossover network in the frequency domain and
                                        transformed back to time domain in order to obtain the room impulse response
                                        (Fig. 11.40 ). A criterion which determines the crossover frequency where the
                                        simulation can be “ switched ” from the time-consuming wave models to
                                        geometrical acoustics, however, cannot be given in a general rule of thumb. As
                                        long as the room transfer function for the given source-receiver combination
                                        contains speci fi c wave effects such as diffraction and modes (under a balcony,
                                        for instance) wave models are required. In the same room but at other
                                        source-receiver combinations, pure geomet- rical models may lead to results with
                                        acceptable accuracy.</p>
                                    <h3 id="11.8-hybrid-wave-and-geometrical-acoustics-models-217"
                                        class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.8
                                        Hybrid Wave and Geometrical Acoustics Models 217</h3>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_40_46.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.40 Crossover network for merging results from wave models and from
                                        geometrical acoustics. (After Aretz and Vorländer 2014b)</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">An
                                        alternative is to pre-calculate room transfer functions and the corresponding
                                        impulse responses with wave models and to implement them in a lock-up table for
                                        real-time processing, which was mainly introduced for application in games. 21
                                    </p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">As
                                        concerns physics-based models with a demand for correctness in comparison with
                                        real space, the largest problem, however, is the identi fi cation of boundary
                                        conditions for wave models. Real constructions are much more complex than an
                                        analytic or numerical boundary condition model (porous material model, resonator
                                        model) can imply. A lightweight construction such as gypsum boards screwed on
                                    </p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">21
                                        https://docs.microsoft.com/en-us/gaming/acoustics/what-is-acoustics</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">218 11
                                        Simulation of Sound in Rooms</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">metal
                                        studs, for example, has a complex vibration pattern depending on the screws ’
                                        positions, the rigidity of the connection, the stiffness of the metal studs, the
                                        airgap fi lling with mineral wool, etc. Its random incidence absorption coef fi
                                        cient can be estimated in standardized type testing for the construction as such
                                        but the “ real ” impedance boundary condition of a speci fi c sample
                                        construction in situ may differ from the type speci fi cation quite a bit. When
                                        it comes to precision of simulation results, furthermore, it is not suf fi cient
                                        to model the construction in FEM or BEM with an impedance boundary condition
                                        since the construction is non-locally reacting with an impedance depending on
                                        the angle of incidence (see Sect. 3.2 ). Here, also FEM and BEM do produce
                                        systematic errors, and only a fl uid-structure coupling between air and the
                                        construction would lead to better model results. Compromises must be found, and
                                        whether these are appropriate depends very much on the speci fi c case. Car
                                        passenger compartments, for example, are among the most dif fi cult environments
                                        due to the complexity of surface materials (Aretz and Vorländer 2014a). Similar
                                        problems can be expected in train and airplane compart- ments. These examples
                                        demonstrate that wave models may be nominally accurate as they solve the wave
                                        equation exactly but the results in room acoustics are heavily affected by
                                        uncertain input data. Now, that the basics of hybrid room acoustic modelling
                                        techniques are known, we can discuss the next step: the creation of impulse
                                        responses for auralization. This only is reasonable when including binaural or
                                        other kind of spatial technology.</p>
                                    <h3 id="11.9-filter-construction-of-spatial-room-impulse-responses"
                                        class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.9
                                        Filter Construction of Spatial Room Impulse Responses</h3>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        Impulse responses suitable for signal processing and particularly for
                                        auralization must have a sampling rate appropriate for the audio frequency
                                        range, typically about 40 kHz (Fig. 11.41 ). Thus, image source algorithms or
                                        hybrid models are applicable. The impulse responses are fed into FIR fi lters
                                        for convolution with dry source signals. Room auralization shall be based on 3D
                                        audio formats. Otherwise, the spatial information would be lost. By using HRTF
                                        (see Sect. 6.4.1 ), the directional</p>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_41_47.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.41 Auralization of sound in rooms</p>
                                    <h3 id="11.9-filter-construction-of-spatial-room-impulse-responses-219"
                                        class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.9
                                        Filter Construction of Spatial Room Impulse Responses 219</h3>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        information of a human listener is taken into account. Alternatively, the
                                        directional impulse response can be encoded in spatial audio formats such as
                                        ambisonics or VBAP; see 11.9.1 . During the historical development of the
                                        auralization of rooms, the fi rst studies were based on purely specular re fl
                                        ections. After the principles had been proposed by Schroeder et al. (1962) and
                                        Schroeder (1973), one of the fi rst who created a signal processing concept for
                                        room acoustics auralization was Pösselt (Pösselt et al. 1986), who used image
                                        source models for rectangular rooms. 22 The model was further extended by
                                        Lehnert and Blauert (1989, 1992), Lehnert (1992) and Vian and Martin (1992). The
                                        purely specular re fl ection model, however, was not suf fi cient, due to lack
                                        of scattering, as we know today. But his important and novel contribution was
                                        the rigorous description of the room impulse response on the basis of spatial
                                        direct sound and re fl ections. With this deeper understanding of the details in
                                        room impulse responses and their relevance for auralization available to other
                                        researchers, extended model approaches including hybrid models and scattering
                                        models in particular have been developed. Since data of air attenuation and
                                        particularly the absorption coef fi cients of walls are available in frequency
                                        bands, the spectral representation required for the impulse response components
                                        must be created by interpolation.</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        Interpolation Several interpolation algorithms are possible candidates. The
                                        cubic spline interpo- lation is one example for a well-quali fi ed method to
                                        create interpolated data. For interpolation of re fl ection factors from octave
                                        band data (see also 11.2.2 ), effects of interpolation in frequency and time
                                        domain must be discussed. Too rough interpo- lation may cause audible ringing.
                                        Onset and decay of the interpolation fi lter creates a kind of tonal
                                        reverberation.</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        Mommertz (1996) showed that absorption coef fi cients in one-third octave bands
                                        serve well for the reconstruction of the complex re fl ection factor. While the
                                        modulus of the re fl ection factor can be obtained directly, a plausible phase
                                        must be added. Minimum or linear phases are options. Only for very few cases,
                                        like for focuses, the speci fi c choice will be important (Fig. 11.42 ). After
                                        inverse Fourier transformation, a spectrum consisting of M complex coef- fi
                                        cients corresponds to a signal of M samples. Each convolution of the signal and
                                        transfer function of M lines in the frequency domain creates a result of M
                                        lines, too. In contrast, in time domain convolution, the result contains 2 M
                                        samples (Fig. 11.43 ).</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        Reverberation Tail As explained above, stochastic effects such as scattering
                                        play an important role particularly in the late response. Starting with the idea
                                        of spatial and temporal re fl ection patterns, the contributions of the
                                        scattered and late part of the impulse response are represented by a set of
                                        noise-equivalent stochastic re fl ections H j , the</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">22 The
                                        reason for this is clearly the limitation by processing time in the late 1980s.
                                    </p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">220 11
                                        Simulation of Sound in Rooms</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.42 Step (dotted line), linear (broken line) and spline interpolation of
                                        spectra based on octave band data (example)</p>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_42_49.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_43_49.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.43 Result of an interpolation of re fl ection factors created from
                                        one-third-octave band absorption coef fi cients. Plot in time domain (maxima
                                        clipped). Spline interpolation between one-third octave bands corresponds to the
                                        continuous line. Too rough interpolation (step function) corresponds to the
                                        dotted line (ringing effects)</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        arrangement of which must be constructed in a fi lter model. The basis for this
                                        kind of construction may be stochastic ray tracing, radiosity, free path
                                        statistics or an arti fi cial reverberation process. All methods mentioned yield
                                        estimates of the late impulse response envelope, M 2 ( Δ t , f ), a function of
                                        frequency and time. 23 By adding</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">23
                                        Similar to a modulation function.</p>
                                    <h3 id="11.9-filter-construction-of-spatial-room-impulse-responses-221"
                                        class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.9
                                        Filter Construction of Spatial Room Impulse Responses 221</h3>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">an
                                        adequate fi ne structure which represents the actual re fl ections statistics,
                                        the binaural impulse responses can be created (Heinz 1993; Schröder 2011) by “
                                        noise shaping ” .</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">The
                                        parameters of the fi ne structure are the average amplitudes, H j , and the
                                        density, n j , of the re fl ections in the time interval Δ t . The set of re fl
                                        ections yield the correct modulation if</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">M 2 Δ
                                        t ð Þ ¼ H j   2  n j ð 11 : 52 Þ</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">for
                                        all frequency bands. The choice of the speci fi c algorithm for estimating the
                                        late response, the band- width, the size of the time intervals and spatial
                                        resolution of the HRTF are subject of research and development in many places.
                                        It is clear that fi ne details of the late response can usually not be
                                        perceived. If, however, the room creates an echo in the late response and this
                                        was not detected and modelled in the simulation, the auralization will miss an
                                        important feature of the room. Hence, there exists no simple rule on how the
                                        parameters of the late response and the transition time between the early and
                                        the late response must be chosen. So far, in this chapter it was referred to the
                                        fi lter construction for sound pressure impulse responses which corresponds to
                                        measurements with omnidirectional pres- sure microphones. As soon as the spatial
                                        information shall be taken into consider- ation, spatial audio standards are
                                        introduced into the room impulse response fi lter; there are two fundamental
                                        approaches possible, as will be described in 11.9.1 and 11.9.2 (Fig. 11.44 ).
                                    </p>
                                    <h4 id="11.9.1-encoding-of-spatial-room-impulse-response-filters"
                                        class="text-xl font-semibold mt-6 mb-3 text-gray-800 dark:text-gray-200">11.9.1
                                        Encoding of Spatial Room Impulse Response Filters</h4>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">A
                                        spatial impulse response is created from direct sound, early re fl ections,
                                        scattered components and reverberation by using the concept of plane wave
                                        decomposition (Sect. 2.6 ) in a spatial audio format such as spherical
                                        harmonics, for example. In the formulation in the frequency domain, 24 this
                                        process is described by the multiplica- tion of the plane-wave fi lter functions
                                        representing sound travelling from the source to the receiver via various paths
                                        until it arrives at the receiver under the angles ϑ , φ . In such spatial audio
                                        formats, the receiver is a spherical microphone array. The incoming components
                                        of the impulse response contributions arriving at the micro- phone array are
                                        decomposed one by one and fi nally added in a superposition process. The
                                        amplitude vector, B m n , of a ray from the direction of ϑ , φ reads (Daniel
                                        2000)</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">24 In
                                        time domain the same can of course be formulated by convolution, but the
                                        spectral product terms are more comfortable to interpret.</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">222 11
                                        Simulation of Sound in Rooms</p>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_44_51.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.44 Omnidirectional sound pressure room impulse response created from specular
                                        (grey) and diffuse (black) re fl ections. (Example after Schröder et al. 2007)
                                    </p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">B m n
                                        ¼ 4 π ﬃﬃﬃﬃﬃﬃ  1 p n Y m n ϑ , φ ð Þ p ϑ , φ ð Þ ð 11 : 53 Þ</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">p ϑ ,
                                        φ ð Þ ¼ e  j ω t j ct j  H source θ , ϕ ð Þ  H air  Y n j</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">R i ð
                                        11 : 54 Þ</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">i ¼ 1
                                    </p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">with p
                                        ( ϑ , φ ) denoting the sound pressure spectrum of the j th re fl ection, t j its
                                        delay, j ω t j the phase, 1/( ct j ) the distance law of spherical waves, H
                                        source the source directivity in source coordinates, H air the low-pass fi lter
                                        of air attenuation and R i the re fl ection factors of the walls involved. In
                                        higher-order ambisonics, HOA, for example (see 17.3.2 ), the N -channel signal
                                        vector is encoded by using the spherical harmonic coef fi cients of the speci fi
                                        c directions of all impulse response components. Finally, in decoding the
                                        signals for reproduction, a surrounding loudspeaker array radiates signals
                                        represented by the continuous spatial functions of spherical harmonic base
                                        functions, and all loud- speakers together form an approximation of the integral
                                        over the surrounding sphere. This corresponds to a discrete Spatial Fourier
                                        synthesis with a truncated version of the series of spherical harmonics. The
                                        amplitude vector of the N -channel encoding format in spherical coordinates in a
                                        speci fi ed geometric arrangement of a (virtual) spherical microphone array is
                                    </p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">B ¼ S
                                        Y ð 11 : 55 Þ</p>
                                    <h3 id="11.9-filter-construction-of-spatial-room-impulse-responses-223"
                                        class="text-2xl font-semibold mt-8 mb-4 text-gray-800 dark:text-gray-200">11.9
                                        Filter Construction of Spatial Room Impulse Responses 223</h3>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Fig.
                                        11.45 Encoding of a plane wave (ray) into a multi-channel spherical array format
                                    </p>
                                    <div class="my-8 flex justify-center"><img
                                            src="/content/images/chapter11/11_img_45_52.jpeg"
                                            alt="Figure from Chapter 11" class="max-w-full h-auto rounded-lg shadow-md">
                                    </div>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">Y
                                        denotes the vector of the real-valued spherical harmonics, S the source signal
                                        and B the vector of driving amplitudes of the N loudspeakers. The result of
                                        reconstruc- tion of the incident ray is (see also 2.8 ) (Fig. 11.45 )</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">p ϑ ,
                                        φ ð Þ  X N</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">X n
                                    </p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">ﬃﬃﬃﬃﬃﬃ
                                         1 p n j n kr ð Þ B m n ω ð Þ Y m n ϑ , φ ð Þ ð 11 : 56 Þ</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">m ¼ 
                                        n</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">n ¼ 0
                                    </p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">In
                                        panning techniques such as VBAP, the N -channel loudspeaker amplitude vector is
                                        derived from weights according to the phantom source generation in triangular
                                        loudspeaker subsets. The total fi eld is obtained by superposition of all
                                        impulse response components involved. More details about HOA and VBAP tech-
                                        niques are given in Sect. 17.3.2 .</p>
                                    <h4 id="11.9.2-binaural-room-impulse-response-filters"
                                        class="text-xl font-semibold mt-6 mb-3 text-gray-800 dark:text-gray-200">11.9.2
                                        Binaural Room Impulse Response Filters</h4>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">In
                                        binaural formats the receiver is a human head with its two ears. A binaural
                                        impulse response is created from direct sound, early re fl ections and scattered
                                        components by using the concept of binaural synthesis (Sect. 9.4 ). All
                                        components are added. In the formulation in the frequency domain, 25 this
                                        process is described by the</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">25 In
                                        time domain the same can of course be formulated by convolution, but the
                                        spectral product terms are more comfortable to interpret.</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">224 11
                                        Simulation of Sound in Rooms</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">
                                        multiplication of the transfer and fi lter functions representing sound
                                        travelling from the source to the receiver:</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">H j 
                                        l ,r ¼ e  j ω t j ct j  H source θ , ϕ ð Þ  HRTF ϑ , φ ð Þj l ,r  H air  Y
                                        n j</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">R i ð
                                        11 : 57 Þ</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">i ¼ 1
                                    </p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">with H
                                        j denoting the spectrum of the j th re fl ection, t j its delay, j ω t j the
                                        phase, 1/( ct j ) the distance law of spherical waves, H source the source
                                        directivity in source coordi- nates, H air the low pass of air attenuation, R i
                                        the re fl ection factors of the walls involved and HRTF the head-related
                                        transfer function of the left (l) and right (r) ear of the sound incidence in
                                        listener coordinates at a speci fi ed orientation. 26</p>
                                    <p class="text-gray-800 dark:text-gray-300 leading-relaxed mb-4 text-justify">26
                                        Usually, the listeners are oriented towards the original source or a similar
                                        reference point.</p>
<div id="quiz-11_simulation_of_sound_in_rooms" class="scroll-mt-20"></div>
</div>
